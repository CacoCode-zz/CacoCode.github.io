{"meta":{"title":"CodePlus","subtitle":null,"description":null,"author":"Caco - Zan","url":"https://zcheng.site","root":"/"},"pages":[{"title":"about","date":"2017-11-04T14:39:03.000Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"about/index.html","permalink":"https://zcheng.site/about/index.html","excerpt":"","text":"ç”Ÿæ´»ã€å·¥ä½œå’Œå…´è¶£ ç”Ÿæ´»ä¸­çš„ä¸€äº›äº‹ ğŸ„ğŸ¿â€â™‚ï¸ å·¥ä½œä¸Šçš„ä¸€äº›äº‹ ğŸ’» æ„Ÿå…´è¶£çš„ä¸€äº›äº‹ ğŸ¨ â³"},{"title":"categories","date":"2019-05-03T12:06:28.000Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"categories/index.html","permalink":"https://zcheng.site/categories/index.html","excerpt":"","text":""},{"title":"friends","date":"2019-05-03T12:21:26.000Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"friends/index.html","permalink":"https://zcheng.site/friends/index.html","excerpt":"","text":""},{"title":"ä¸ªäººç®€å†","date":"2020-10-05T12:21:26.000Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"private/resume.html","permalink":"https://zcheng.site/private/resume.html","excerpt":"","text":"åŸºæœ¬èµ„æ–™ å§“åï¼š ç¨‹æ¤ æ€§åˆ«ï¼š ç”· ç”µè¯ï¼š18507152185 ç”µå­é‚®ç®±ï¼š1451426471@qq.com æ±‚èŒæ„å‘ï¼šWebå‰ç«¯ å·¥ä½œå¹´é™ï¼š3å¹´ Github: https://github.com/zchengsite åšå®¢ï¼šhttps://zcheng.site/ å­¦æ ¡ï¼šæ­¦æ±‰è½¯ä»¶å·¥ç¨‹èŒä¸šå­¦é™¢ï¼ˆ2015 - 2018ï¼‰ ä¸“ä¸šï¼šè½¯ä»¶æŠ€æœ¯ ä¸“ä¸šæŠ€èƒ½ ç†Ÿæ‚‰JavaScriptã€HTML5ã€CSS3 ç†Ÿæ‚‰Vue.jsæ¡†æ¶ï¼Œäº†è§£Reactæ¡†æ¶ ç†Ÿæ‚‰å¾®ä¿¡å°ç¨‹åºå¼€å‘ï¼Œäº†è§£ç›¸å…³UIæ¡†æ¶ ç†Ÿæ‚‰ES6è¯­æ³• äº†è§£Python å·¥ä½œç»å† å…¬å¸åç§°ï¼šæ­¦æ±‰æ·±åº¦ç½‘ç§‘æŠ€æœ‰é™å…¬å¸ åœ¨èŒæ—¶é—´ï¼š2017.11.04 - 2020.10.01 èŒä½åç§°ï¼šWebå‰ç«¯ å·¥ä½œæè¿°ï¼š æ„å»ºå…¬å¸å†…éƒ¨åŸºäºVue.jsçš„é€šç”¨æ¡†æ¶ç³»ç»Ÿ è´Ÿè´£å…¬å¸æ ¸å¿ƒäº§å“æ¡†æ¶è®¾è®¡ã€æ ¸å¿ƒä»£ç ç¼–å†™åŠç›¸å…³æ–‡æ¡£ç»´æŠ¤ é…åˆåå°å®Œæˆæ•°æ®æ¥å£è®¾è®¡ã€æ¥å£å¯¹æ¥åŠé¡µé¢æ•°æ®æ¸²æŸ“ åˆ¶å®šéƒ¨é—¨çš„ä»£ç é£æ ¼è§„èŒƒå’ŒGitæäº¤è§„èŒƒå¹¶æ¨åŠ¨éƒ¨é—¨çš„ä»£ç å®¡æ ¸æµç¨‹ å¶æœ‰å‚ä¸åå°æ¥å£ç¼–å†™ã€è„šæœ¬ç¼–å†™ é¡¹ç›®ç»å† åŸºäºVue.jsçš„é€šç”¨æ¡†æ¶æ„å»ºã€å¼€å‘å’Œç»´æŠ¤ é¡¹ç›®æ—¶é—´ï¼š2018.05 - 2020.10 é¡¹ç›®æè¿°ï¼šåŸºäºVue.jsæŠ€æœ¯æ ˆæ­å»ºçš„åå°ç®¡ç†æ¨¡æ¿ï¼Œä¸»è¦æä¾›ç»™å…¬å¸åç»­ä¸šåŠ¡ç³»ç»Ÿå¼€å‘ã€‚ æ–¹æ¡ˆé€‰å‹ï¼šåŸºäºVue CLI 3çš„é»˜è®¤Webpacké…ç½®é¡¹è¿›è¡Œåº“æ„å»ºä¼˜åŒ–å¤„ç†ï¼Œæ•´åˆäº†Remark Admin UI &amp; Element UI &amp; axios &amp; permission control &amp; ESLintç­‰æ’ä»¶å’ŒåŠŸèƒ½ã€‚ è´Ÿè´£å†…å®¹ï¼šæ„å»ºé¡µé¢å¸ƒå±€ç»„ä»¶ã€åŸºç¡€ç»„ä»¶å’Œå¤æ‚ç»„ä»¶ä»¥åŠå¸¸è§å·¥å…·æ–¹æ³•çš„å°è£…ï¼Œæ•´åˆåŠ¨æ€è·¯ç”±ã€æƒé™æ§åˆ¶ä»¥åŠå¸¸è§åŠŸèƒ½ç»„ä»¶æ ·å¼çš„è®¾è®¡ä¸å¼€å‘ã€‚ é£é™©ç›‘æµ‹ä¸é¢„è­¦å¹³å° é¡¹ç›®æ—¶é—´ï¼š2018.06 - 2020.10 é¡¹ç›®æè¿°ï¼šé£é™©ç›‘æµ‹ä¸é¢„è­¦å¹³å°æ˜¯ä¸ºæ±Ÿè‹çœç›‘ç®¡å±€å’Œæ­¦æ±‰å¸‚ç›‘ç®¡å±€æä¾›çš„ç½‘ç»œèˆ†æƒ…é£é™©é¢„è­¦ç³»ç»Ÿï¼Œé€šè¿‡å¯¹è´Ÿé¢ç½‘ç»œèˆ†æƒ…è¿›è¡Œé‡‡é›†ã€åˆ†ç±»ã€åˆ†æä»¥åŠå‘ˆç°ï¼Œæ»¡è¶³çœå¸‚å±€èˆ†æƒ…ç›‘æµ‹å·¥ä½œï¼Œä¸ºé¢†å¯¼å†³ç­–æä¾›å‚è€ƒã€‚ æ–¹æ¡ˆé€‰å‹ï¼šåŸºäºVue.jsçš„é€šç”¨æ¡†æ¶æ„å»ºçš„åå°ç®¡ç†å¹³å°æ¨¡æ¿è¿›è¡Œä¸šåŠ¡ç»„ä»¶å¼€å‘ã€‚ è´Ÿè´£å†…å®¹ï¼š åŸºäºå†…éƒ¨æ¡†æ¶è¿›è¡Œå®šåˆ¶åŒ–å¼€å‘ å‰ç«¯é¡µé¢ã€åŠŸèƒ½ã€ä¸šåŠ¡ç»„ä»¶çš„å¼€å‘ ä¸åç«¯å¯¹æ¥ï¼Œå®Œæˆé¡µé¢æ•°æ®æ¸²æŸ“ä¸äº¤äº’ é¡¹ç›®åœ°å€ï¼šhttps://obs.shendu.info å…¨å›½åŸå¸‚é«˜è´¨é‡å‘å±•å¯è§†åŒ–å¹³å° é¡¹ç›®æ—¶é—´ï¼š2018.10 - 2019.05 é¡¹ç›®æè¿°ï¼šå…¨å›½åŸå¸‚é«˜è´¨é‡å‘å±•å¯è§†åŒ–å¹³å°é€šè¿‡åˆ†æå…¨å›½åŸå¸‚å„ä¸ªæŒ‡æ ‡ï¼Œå¯¹ç›¸åº”åŸå¸‚æŒ‡æ ‡è¿›è¡Œè¯„åˆ†ã€æ’åã€ç»Ÿè®¡ã€‚æœ€ç»ˆé€šè¿‡å›¾è¡¨å½¢å¼å‘ˆç°å‡ºæ¥ã€‚ æ–¹æ¡ˆé€‰å‹ï¼šVue-cli3 + echarts + flex è¿›è¡Œæ­å»ºã€‚ è´Ÿè´£å†…å®¹ï¼š é¡µé¢æ•´ä½“å¸ƒå±€å®ç° éƒ¨åˆ†å›¾è¡¨å®šåˆ¶åŒ–æ ·å¼å®ç° ä¸åç«¯å¯¹æ¥ï¼Œå®Œæˆé¡µé¢æ•°æ®æ¸²æŸ“ä¸äº¤äº’ é¡¹ç›®åœ°å€ï¼šhttp://obs.shendu.info:50/#/ éƒ‘å·å¸‚éƒ‘ä¸œæ–°åŒºå®‰å…¨ç›‘ç®¡å¹³å° é¡¹ç›®æ—¶é—´ï¼š2020.7 - 2020.10 é¡¹ç›®æè¿°ï¼šéƒ‘å·å¸‚éƒ‘ä¸œæ–°åŒºå®‰å…¨ç›‘ç®¡å¹³å°æ˜¯ä¸ºéƒ‘ä¸œæ–°åŒºå®‰å…¨ç”Ÿäº§æä¾›çš„å¯è§†åŒ–ç›‘ç®¡æ–¹æ¡ˆã€‚ æ–¹æ¡ˆé€‰å‹ï¼šVue-cli3 + echarts + element uiï¼Œé‡‡ç”¨flexè¿›è¡Œå¸ƒå±€ï¼Œé€‚åº”å¤šç«¯è®¾å¤‡ã€‚ è´Ÿè´£å†…å®¹ï¼š é¡µé¢æ•´ä½“å¸ƒå±€å®ç° éƒ¨åˆ†å›¾è¡¨å®šåˆ¶åŒ–æ ·å¼å®ç° ä¸åç«¯å¯¹æ¥ï¼Œå®Œæˆé¡µé¢æ•°æ®æ¸²æŸ“ä¸äº¤äº’ é¡¹ç›®åœ°å€ï¼šhttp://obs.shendu.info:86/ username: admin password: 123456"},{"title":"tags","date":"2019-05-03T12:03:35.000Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"tags/index.html","permalink":"https://zcheng.site/tags/index.html","excerpt":"","text":""},{"title":"","date":"2021-01-25T05:45:48.547Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"scss/css-animation-design/base.css","permalink":"https://zcheng.site/scss/css-animation-design/base.css","excerpt":"","text":".rotate-demo.demo-1 { display: inline-block; width: 1rem; height: 1rem; border-radius: 50%; box-shadow: 0 -21px 0 0 #a3afb7, 14px -14px 0 0 #a3afb7, 21px 0 0 0 #a3afb7, 14px 14px 0 0 #a3afb7, 0 21px 0 0 #a3afb7, -14px 14px 0 0 #a3afb7, -21px 0 0 0 #a3afb7, -14px -14px 0 0 #a3afb7; animation: rotate-demo-1 1.5s infinite ease; } @keyframes rotate-demo-1 { 0% { transform: rotate(0deg); } 80% { transform: rotate(280deg); } 100% { transform: rotate(270deg); } } .rotate-demo.demo-2 { display: inline-block; height: 4.5rem; width: 4.5rem; border: 4px solid gray; border-bottom-color: transparent; border-radius: 50%; animation: rotate-demo-2 1s infinite linear; } @keyframes rotate-demo-2 { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } .jump-demo.demo-1 { position: relative; height: 8rem; width: 16rem; border-bottom: 2px solid gray; } .jump-demo.demo-1::before { content: \"\"; position: absolute; bottom: 0; left: 3rem; width: 3rem; height: 3rem; border-radius: 5px; background-color: gray; transform-origin: center center; animation: jump-demo-1 1.2s infinite ease-in-out alternate; } .jump-demo.demo-1::after { content: \"\"; position: absolute; bottom: 0; left: 10rem; width: 3rem; height: 3rem; border-radius: 5px; background-color: gray; transform-origin: -80% center; animation: jump-demo-2 1.2s infinite linear alternate, jump-demo-2-2 1.2s infinite ease; } @keyframes jump-demo-1 { from { transform: translateX(0); } to { transform: translateX(7rem); } } @keyframes jump-demo-2 { 0%, 20% { transform: rotate(0); } 80%, 100% { transform: rotate(-180deg); } } @keyframes jump-demo-2-2 { 0%, 80% { width: 3rem; height: 3rem; } 82%, 86% { width: 3.5rem; height: 2.5rem; } } .jump-demo.demo-2 { position: relative; width: 10rem; height: 0.3rem; margin: 10rem 0 0 0; background-color: gray; animation: jump-demo-rubberBand 0.8s infinite ease; } .jump-demo.demo-2::before { content: \"\"; position: absolute; left: 3.5rem; bottom: 0; width: 3rem; height: 3rem; background-color: gray; border-radius: 5px; transform-origin: center; animation: jump-demo-top-bottom 0.8s infinite linear, jump-demo-rotate 1.5s infinite linear; } @keyframes jump-demo-rubberBand { 0%, 40% { transform: scale3d(1, 1, 1); } 50% { transform: scale3d(1.25, 0.75, 1); } 60%, 100% { transform: scale3d(1, 1, 1); } } @keyframes jump-demo-top-bottom { 0% { bottom: 5rem; } 3% { bottom: 4.9rem; } 6% { bottom: 4.8rem; } 9% { bottom: 4.7rem; } 12% { bottom: 4.6rem; } 15% { bottom: 4.5rem; } 18% { bottom: 4.4rem; } 21% { bottom: 4.3rem; } 24% { bottom: 4.2rem; } 50% { bottom: 0.3rem; } 76% { bottom: 4.2rem; } 79% { bottom: 4.3rem; } 82% { bottom: 4.4rem; } 85% { bottom: 4.5rem; } 88% { bottom: 4.6rem; } 91% { bottom: 4.7rem; } 94% { bottom: 4.8rem; } 97% { bottom: 4.9rem; } 100% { bottom: 5rem; } } @keyframes jump-demo-rotate { 0% { transform: rotate(0); } 100% { transform: rotate(270deg); } }"},{"title":"","date":"2021-01-25T05:45:48.547Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"scss/something-about-css.css","permalink":"https://zcheng.site/scss/something-about-css.css","excerpt":"","text":"@charset \"UTF-8\"; /*transition-demo*/ .transition-demo { position: relative; cursor: pointer; color: #24292e; transition: all 0.1s; /*demo1*/ /*demo-2*/ } .transition-demo.demo-1::after { content: \"\"; position: absolute; left: 0; right: 0; bottom: 0; transition: transform 0.3s ease; height: 2px; background: linear-gradient(to right, #24292e, #666); transform: scaleX(0); transform-origin: center right; } .transition-demo.demo-1:hover::after { transform: scaleX(1); transform-origin: center left; } .transition-demo.demo-2:hover { color: #fff; z-index: 1; } .transition-demo.demo-2::after { content: \"\"; position: absolute; top: 0; bottom: 0; left: -2px; right: -2px; transition: transform 0.1s linear; background: linear-gradient(#24292e, #666); transform: scaleY(0); transform-origin: bottom; z-index: -1; } .transition-demo.demo-2:hover::after { transform: scaleY(1); } .transition-demo.demo-3-parent { padding: 2px 0; } .transition-demo.demo-3-parent::before, .transition-demo.demo-3-parent::after { content: \"\"; position: absolute; background: #262626; transform: scaleX(0); transition: transform 0.3s; left: 0; right: 0; height: 2px; } .transition-demo.demo-3-parent::before { top: 0; transform-origin: center right; } .transition-demo.demo-3-parent::after { bottom: 0; transform-origin: center left; } .transition-demo.demo-3-parent:hover::before { transform-origin: center left; transform: scaleX(1); } .transition-demo.demo-3-parent:hover::after { transform-origin: center right; transform: scaleX(1); } .transition-demo.demo-3-child { padding: 0 2px; } .transition-demo.demo-3-child::before, .transition-demo.demo-3-child::after { content: \"\"; position: absolute; background: #262626; transform: scaleY(0); transition: transform 0.3s; top: 0; bottom: 0; width: 2px; } .transition-demo.demo-3-child::before { left: 0; transform-origin: center top; } .transition-demo.demo-3-child::after { right: 0; transform-origin: center bottom; } .transition-demo.demo-3-child:hover::before { transform-origin: center bottom; transform: scaleY(1); } .transition-demo.demo-3-child:hover::after { transform-origin: center top; transform: scaleY(1); } /*animation-demo*/ /*demo-1*/ .animation-demo.demo-1 { width: 2em; height: 2em; border-radius: 50%; background: gray; animation: animation-demo-1 1s infinite ease-in-out; } @keyframes animation-demo-1 { 0% { transform: scale(0); } 100% { opacity: 0; transform: scale(1); } } .animation-demo.demo-2 { position: relative; width: 1.5em; height: 1.5em; border-radius: 50%; animation: animation-demo-2 2s infinite ease-in-out both 0s; } .animation-demo.demo-2::before { width: 1.5em; height: 1.5em; border-radius: 50%; animation: animation-demo-2 2s infinite ease-in-out both 0.2s; content: \"\"; position: absolute; left: 2em; } .animation-demo.demo-2::after { width: 1.5em; height: 1.5em; border-radius: 50%; animation: animation-demo-2 2s infinite ease-in-out both 0.4s; content: \"\"; position: absolute; left: 4em; } @keyframes animation-demo-2 { 0%, 100% { box-shadow: 0 1.5em 0 -1.5em gray; } 50% { box-shadow: 0 1.5em 0 0 gray; } } /*css filter*/ /*filter-shadow*/ /*demo1 2 3*/ .filter-shadow { margin: 0 10px; display: inline-block; height: 100px; width: 100px; border-radius: 50%; background-position: center; background-size: cover; background-repeat: no-repeat; position: relative; } .filter-shadow::after { content: \"\"; height: 100%; width: 100%; border-radius: 50%; z-index: -1; background: inherit; position: absolute; top: 10px; left: 0; filter: blur(10px) brightness(80%) opacity(0.8); transform: scale(0.95); } .filter-shadow.demo-1 { background-image: url(\"https://qiniu.zcheng.site/something-about-css-css-filter-test1.png\"); } .filter-shadow.demo-2 { background-image: url(\"https://qiniu.zcheng.site/something-about-css-css-filter-test2.png\"); } .filter-shadow.demo-3 { background-image: url(\"https://qiniu.zcheng.site/something-about-css-css-filter-test3.png\"); } /*acrylic*/ /*demo-1*/ .acrylic-filer.demo-1 { height: 300px; width: 100%; background: url(\"https://qiniu.zcheng.site/something-about-css-acrylic.png\") no-repeat center/contain; background-attachment: fixed; display: flex; justify-content: center; align-items: center; } .acrylic-filer.demo-1 .acrylic { padding: 4em 6em; position: relative; z-index: 1; overflow: hidden; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1), 0 1px 8px rgba(0, 0, 0, 0.2); } .acrylic-filer.demo-1 .acrylic::before { filter: blur(10px); content: \"\"; position: absolute; left: -10px; top: -10px; right: -10px; bottom: -10px; width: calc(100% + 20px); height: calc(100% + 20px); z-index: -1; background: url(\"https://qiniu.zcheng.site/something-about-css-acrylic.png\") no-repeat center/contain; background-attachment: fixed; } .acrylic-filer.demo-1 .acrylic::after { content: \"\"; position: absolute; top: 0; bottom: 0; left: 0; right: 0; background: rgba(255, 255, 255, 0.7); z-index: -1; } .acrylic-backdrop-filter.demo-2 { height: 300px; width: 100%; background: url(\"https://qiniu.zcheng.site/something-about-css-acrylic.png\") no-repeat center/contain; background-attachment: fixed; display: flex; justify-content: center; align-items: center; } .acrylic-backdrop-filter.demo-2 .acrylic { padding: 4em 6em; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1), 0 1px 8px rgba(0, 0, 0, 0.2); background: rgba(255, 255, 255, 0.7); -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px); background-blend-mode: exclusion; } /*css border*/ .border-demo { position: relative; background: gray; color: #fff; text-align: center; cursor: pointer; /*å‚ç›´å°ä¹¦ç­¾*/ /*æ°´å¹³å°ä¹¦ç­¾*/ /*æ°´å¹³å¸¦å°æŠ˜è§’ä¹¦ç­¾*/ } .border-demo.demo-1 { height: 4.2rem; width: 2.8rem; font-size: 1.5rem; line-height: 2rem; } .border-demo.demo-1::after { content: \"\"; position: absolute; left: 0; top: 100%; border: 1.4rem solid gray; border-top-width: 0; border-bottom-color: transparent; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; } .border-demo.demo-2 { height: 2.8rem; width: 4.2rem; font-size: 1.5rem; line-height: 2.8rem; } .border-demo.demo-2::after { content: \"\"; position: absolute; left: 100%; top: 0; border: 1.4rem solid gray; border-left-width: 0; border-right-color: transparent; border-top-right-radius: 3px; border-bottom-right-radius: 3px; } .border-demo.demo-3 { height: 2.8rem; width: 12rem; font-size: 1.5rem; line-height: 2.8rem; } .border-demo.demo-3::after { content: \"\"; position: absolute; left: 100%; top: 0; border: 1.4rem solid gray; border-left-width: 0; border-right-color: transparent; border-top-right-radius: 3px; border-bottom-right-radius: 3px; } .border-demo.demo-3:before { content: \"\"; position: absolute; left: 0; top: -1.6rem; border: 0.8rem solid #555555; border-top-color: transparent; border-left-color: transparent; } .border-demo.demo-4 { width: 0rem; height: 0rem; position: relative; margin-left: 20px; } .border-demo.demo-4::before { content: \"\"; position: absolute; border: 1rem solid gray; border-bottom-left-radius: 3px; right: 0; border-top-color: transparent; border-left-color: transparent; border-bottom-left-radius: 3px; } .border-demo.demo-4::after { content: \"\"; position: absolute; border: 1rem solid gray; border-bottom-left-radius: 3px; left: 0; border-bottom-color: transparent; border-right-color: transparent; border-top-right-radius: 3px; } .border-demo .demo-5-1 { width: 0rem; height: 0rem; position: relative; margin: 0 20px; } .border-demo .demo-5-1::before { content: \"\"; position: absolute; border: 1rem solid gray; animation: border-demo-5 infinite ease-in-out both 1.5s; transform-origin: right center; border-top-color: transparent; border-left-color: transparent; border-bottom-left-radius: 3px; right: 0; } .border-demo .demo-5-1::after { content: \"\"; position: absolute; border: 1rem solid gray; animation: border-demo-5 infinite ease-in-out both 1.5s; transform-origin: left center; border-bottom-color: transparent; border-right-color: transparent; border-top-right-radius: 3px; left: 0; } .border-demo .demo-5-2 { width: 0rem; height: 0rem; position: relative; margin: 0 50px; } .border-demo .demo-5-2::before { content: \"\"; position: absolute; border: 1rem solid gray; animation: border-demo-5 infinite ease-in-out both 1.5s; transform-origin: right center; border-top-color: transparent; border-left-color: transparent; animation-delay: 0.2s; border-bottom-left-radius: 3px; right: 0; } .border-demo .demo-5-2::after { content: \"\"; position: absolute; border: 1rem solid gray; animation: border-demo-5 infinite ease-in-out both 1.5s; transform-origin: left center; animation-delay: 0.2s; border-bottom-color: transparent; border-right-color: transparent; border-top-right-radius: 3px; left: 0; } .border-demo .demo-5-3 { width: 0rem; height: 0rem; position: relative; margin: 0 80px; } .border-demo .demo-5-3::before { content: \"\"; position: absolute; border: 1rem solid gray; animation: border-demo-5 infinite ease-in-out both 1.5s; transform-origin: right center; border-top-color: transparent; border-left-color: transparent; animation-delay: 0.4s; border-bottom-left-radius: 3px; right: 0; } .border-demo .demo-5-3::after { content: \"\"; position: absolute; border: 1rem solid gray; animation: border-demo-5 infinite ease-in-out both 1.5s; transform-origin: left center; animation-delay: 0.4s; border-bottom-color: transparent; border-right-color: transparent; border-top-right-radius: 3px; left: 0; } @keyframes border-demo-5 { 0%, 100% { transform: scale(1); } 50% { transform: scale(0); } } .border-demo.demo-6 { height: 1.5rem; width: 1rem; background: transparent; border-radius: 3px; animation: border-demo-6 1.8s infinite ease-in-out 0s both; position: relative; margin: 0 40px; transform: skewX(-25deg); } .border-demo.demo-6::before { height: 1.5rem; width: 1rem; background: transparent; border-radius: 3px; animation: border-demo-6 1.8s infinite ease-in-out -0.16s both; content: \"\"; position: absolute; left: -20px; top: 0; } .border-demo.demo-6::after { height: 1.5rem; width: 1rem; background: transparent; border-radius: 3px; animation: border-demo-6 1.8s infinite ease-in-out 0.16s both; content: \"\"; position: absolute; right: -20px; top: 0; } @keyframes border-demo-6 { 0%, 80%, 100% { box-shadow: 0 1.5rem 0 -0.75rem gray; } 40% { box-shadow: 0 1.5rem 0 0 gray; } } .border-demo.demo-7 { position: relative; background-color: #fff; height: 50px; width: 36px; border-top: 2px solid gray; border-bottom: 2px solid gray; animation: border-demo-7 3.2s infinite ease-out; } .border-demo.demo-7::before { position: absolute; top: -1px; left: 3px; content: \"\"; width: 26px; height: 23px; border-width: 0 2px 1px 2px; border-style: solid; border-color: gray; border-radius: 0 0 100% 100% / 0 0 180% 180%; } .border-demo.demo-7::after { position: absolute; bottom: -1px; left: 3px; content: \"\"; width: 26px; height: 23px; border-width: 1px 2px 0 2px; border-style: solid; border-color: gray; border-radius: 100% 100% 0 0 / 180% 180% 0 0; } @keyframes border-demo-7 { 0% { transform: rotate(0deg); } 35% { transform: rotate(181deg); } 40%, 50% { transform: rotate(180deg); } 85% { transform: rotate(361deg); } 90%, 100% { transform: rotate(360deg); } } .border-button-demo.demo-1 { display: inline-block; position: relative; } .border-button-demo.demo-1:hover::before { content: \"\"; z-index: 10; position: absolute; border-top-left-radius: 3px; border-bottom-right-radius: 3px; border-top-right-radius: 3px; animation: border-button-top-right 1s infinite ease-in-out both; } .border-button-demo.demo-1:hover::after { content: \"\"; z-index: 10; position: absolute; border-top-right-radius: 3px; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; animation: border-button-bottom-right 1s infinite ease-in-out both; } .border-button-demo.demo-1 button { position: relative; padding: 1.2rem 2rem; line-height: 1; background: #fff; border-width: 0; background: #eee; color: #606266; text-align: center; cursor: pointer; border-radius: 4px; outline: none; } .border-button-demo.demo-1 button:hover { color: #409eff; border-color: transparent; background-color: #ecf5ff; border-width: 0; } .border-button-demo.demo-1 button:hover::before { content: \"\"; z-index: 10; position: absolute; border-top-right-radius: 3px; border-bottom-left-radius: 3px; border-top-left-radius: 3px; animation: border-button-top-left 1s infinite ease-in-out both; } .border-button-demo.demo-1 button:hover::after { content: \"\"; z-index: 10; position: absolute; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-bottom-left-radius: 3px; animation: border-button-bottom-left 1s infinite ease-in-out both; } @keyframes border-button-top-left { 0%, 100% { left: -.3rem; top: -.3rem; border: .6rem solid #409eff; border-right-color: transparent; border-bottom-color: transparent; } 50% { left: -.5rem; top: -.5rem; border: 0.6rem solid #a0cfff; border-right-color: transparent; border-bottom-color: transparent; } } @keyframes border-button-bottom-left { 0%, 100% { left: -.3rem; bottom: -.3rem; border: .6rem solid #409eff; border-right-color: transparent; border-top-color: transparent; } 50% { left: -.5rem; bottom: -.5rem; border: 0.6rem solid #a0cfff; border-right-color: transparent; border-top-color: transparent; } } @keyframes border-button-top-right { 0%, 100% { right: -.3rem; top: -.3rem; border: .6rem solid #409eff; border-left-color: transparent; border-bottom-color: transparent; } 50% { right: -.5rem; top: -.5rem; border: 0.6rem solid #a0cfff; border-left-color: transparent; border-bottom-color: transparent; } } @keyframes border-button-bottom-right { 0%, 100% { right: -.3rem; bottom: -.3rem; border: .6rem solid #409eff; border-left-color: transparent; border-top-color: transparent; } 50% { right: -.5rem; bottom: -.5rem; border: 0.6rem solid #a0cfff; border-left-color: transparent; border-top-color: transparent; } } .shadow-demo.demo-1 { position: relative; width: 100%; height: 50rem; background-image: url(\"https://qiniu.zcheng.site/something-about-css-panel-bg.png\"); border-radius: 10px; z-index: 9; overflow: hidden; } .shadow-demo.demo-1 .card-1 { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40%; height: 40rem; background-color: #fff; box-shadow: 2px 2px 5px 0px #1f1f1f; } .shadow-demo.demo-1 .card-1 .card-title { position: absolute; top: 30%; left: 50%; transform: translate(-50%, -50%); font-size: 36px; font-weight: bold; } .shadow-demo.demo-1 .card-1 .card-footer { position: absolute; bottom: 10%; left: 50%; transform: translate(-50%, -50%); font-size: 14px; font-weight: bold; } .shadow-demo.demo-1 .shadow-demo-item.ellipse-900 { position: absolute; top: 0; left: 0; bottom: 0; right: 0; z-index: 10; transform: rotate(-66deg); transform-origin: center; filter: blur(15px); background: linear-gradient(transparent 60%, rgba(0, 0, 0, 0.6) 15%); background-size: 100% 18%; } /*to-be-continued*/ .to-be-continued dot { display: inline-block; overflow: hidden; height: 1em; line-height: 1; vertical-align: -.25em; } .to-be-continued dot::after { display: block; white-space: pre-wrap; content: \"...\\A..\\A.\"; animation: loading 3s infinite step-start both; } @keyframes loading { 33% { transform: translate3d(0, -2em, 0); } 66% { transform: translate3d(0, -1em, 0); } }"},{"title":"","date":"2021-01-25T05:45:48.547Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"scss/pixel-icon-design/base.css","permalink":"https://zcheng.site/scss/pixel-icon-design/base.css","excerpt":"","text":".pixel-slime { height: 100px; width: 105px; position: relative; display: inline-block; margin: 20px; } .pixel-slime::before { content: \"\"; position: absolute; width: 5px; height: 5px; top: -5px; left: -5px; box-shadow: 65px 5px #5b9bd5, 55px 10px #5b9bd5, 60px 10px #5b9bd5, 70px 10px #5b9bd5, 40px 15px #5b9bd5, 45px 15px #5b9bd5, 50px 15px #5b9bd5, 75px 15px #5b9bd5, 30px 20px #5b9bd5, 35px 20px #5b9bd5, 80px 20px #5b9bd5, 20px 25px #5b9bd5, 25px 25px #5b9bd5, 85px 25px #5b9bd5, 90px 25px #5b9bd5, 15px 30px #5b9bd5, 95px 30px #5b9bd5, 10px 35px #5b9bd5, 100px 35px #5b9bd5, 10px 40px #5b9bd5, 100px 40px #5b9bd5, 5px 45px #5b9bd5, 105px 45px #5b9bd5, 5px 50px #5b9bd5, 105px 50px #5b9bd5, 5px 55px #5b9bd5, 105px 55px #5b9bd5, 5px 60px #5b9bd5, 105px 60px #5b9bd5, 5px 65px #5b9bd5, 105px 65px #5b9bd5, 5px 70px #5b9bd5, 105px 70px #5b9bd5, 10px 75px #5b9bd5, 100px 75px #5b9bd5, 10px 80px #5b9bd5, 100px 80px #5b9bd5, 15px 85px #5b9bd5, 95px 85px #5b9bd5, 20px 90px #5b9bd5, 25px 90px #5b9bd5, 85px 90px #5b9bd5, 90px 90px #5b9bd5, 30px 95px #5b9bd5, 35px 95px #5b9bd5, 75px 95px #5b9bd5, 80px 95px #5b9bd5, 40px 100px #5b9bd5, 45px 100px #5b9bd5, 50px 100px #5b9bd5, 55px 100px #5b9bd5, 60px 100px #5b9bd5, 65px 100px #5b9bd5, 70px 100px #5b9bd5, 65px 10px #ddebf7, 55px 15px #ddebf7, 60px 15px #ddebf7, 70px 15px #ddebf7, 50px 20px #ddebf7, 75px 20px #ddebf7, 80px 25px #ddebf7, 85px 30px #ddebf7, 90px 30px #ddebf7, 15px 35px #ddebf7, 100px 55px #ddebf7, 100px 60px #ddebf7, 85px 65px #ddebf7, 15px 60px #ddebf7, 40px 20px #f2f7fc, 45px 20px #f2f7fc, 30px 25px #f2f7fc, 35px 25px #f2f7fc, 20px 30px #f2f7fc, 25px 30px #f2f7fc, 95px 35px #f2f7fc, 95px 40px #f2f7fc, 100px 45px #f2f7fc, 100px 50px #f2f7fc, 25px 50px #f2f7fc, 20px 60px #f2f7fc, 70px 55px #f2f7fc, 80px 65px #f2f7fc, 65px 15px #bdd7ee, 55px 20px #bdd7ee, 60px 20px #bdd7ee, 65px 20px #bdd7ee, 70px 20px #bdd7ee, 40px 25px #bdd7ee, 45px 25px #bdd7ee, 50px 25px #bdd7ee, 55px 25px #bdd7ee, 60px 25px #bdd7ee, 65px 25px #bdd7ee, 70px 25px #bdd7ee, 75px 25px #bdd7ee, 30px 30px #bdd7ee, 35px 30px #bdd7ee, 40px 30px #bdd7ee, 45px 30px #bdd7ee, 50px 30px #bdd7ee, 55px 30px #bdd7ee, 60px 30px #bdd7ee, 65px 30px #bdd7ee, 70px 30px #bdd7ee, 75px 30px #bdd7ee, 80px 30px #bdd7ee, 20px 35px #bdd7ee, 25px 35px #bdd7ee, 30px 35px #bdd7ee, 35px 35px #bdd7ee, 40px 35px #bdd7ee, 45px 35px #bdd7ee, 50px 35px #bdd7ee, 55px 35px #bdd7ee, 60px 35px #bdd7ee, 65px 35px #bdd7ee, 70px 35px #bdd7ee, 75px 35px #bdd7ee, 80px 35px #bdd7ee, 85px 35px #bdd7ee, 90px 35px #bdd7ee, 15px 40px #bdd7ee, 20px 40px #bdd7ee, 25px 40px #bdd7ee, 30px 40px #bdd7ee, 35px 40px #bdd7ee, 40px 40px #bdd7ee, 45px 40px #bdd7ee, 50px 40px #bdd7ee, 55px 40px #bdd7ee, 60px 40px #bdd7ee, 65px 40px #bdd7ee, 70px 40px #bdd7ee, 75px 40px #bdd7ee, 80px 40px #bdd7ee, 85px 40px #bdd7ee, 90px 40px #bdd7ee, 10px 45px #bdd7ee, 15px 45px #bdd7ee, 20px 45px #bdd7ee, 25px 45px #bdd7ee, 30px 45px #bdd7ee, 90px 45px #bdd7ee, 95px 45px #bdd7ee, 10px 50px #bdd7ee, 15px 50px #bdd7ee, 20px 50px #bdd7ee, 95px 50px #bdd7ee, 10px 55px #bdd7ee, 15px 55px #bdd7ee, 10px 60px #bdd7ee, 10px 65px #bdd7ee, 10px 70px #bdd7ee, 15px 75px #bdd7ee, 15px 80px #bdd7ee, 20px 85px #bdd7ee, 25px 85px #bdd7ee, 30px 90px #bdd7ee, 35px 90px #bdd7ee, 100px 65px #bdd7ee, 100px 70px #bdd7ee, 95px 75px #bdd7ee, 95px 80px #bdd7ee, 85px 85px #bdd7ee, 90px 85px #bdd7ee, 75px 90px #bdd7ee, 80px 90px #bdd7ee, 40px 95px #bdd7ee, 45px 95px #bdd7ee, 50px 95px #bdd7ee, 55px 95px #bdd7ee, 60px 95px #bdd7ee, 65px 95px #bdd7ee, 70px 95px #bdd7ee, 20px 55px #b4c6e7, 35px 45px #b4c6e7, 40px 45px #b4c6e7, 45px 45px #b4c6e7, 50px 45px #b4c6e7, 55px 45px #b4c6e7, 60px 45px #b4c6e7, 65px 45px #b4c6e7, 70px 45px #b4c6e7, 75px 45px #b4c6e7, 80px 45px #b4c6e7, 85px 45px #b4c6e7, 35px 50px #b4c6e7, 40px 50px #b4c6e7, 45px 50px #b4c6e7, 50px 50px #b4c6e7, 55px 50px #b4c6e7, 60px 50px #b4c6e7, 65px 50px #b4c6e7, 70px 50px #b4c6e7, 75px 50px #b4c6e7, 80px 50px #b4c6e7, 85px 50px #b4c6e7, 90px 50px #b4c6e7, 35px 55px #b4c6e7, 40px 55px #b4c6e7, 45px 55px #b4c6e7, 50px 55px #b4c6e7, 55px 55px #b4c6e7, 60px 55px #b4c6e7, 65px 55px #b4c6e7, 80px 55px #b4c6e7, 85px 55px #b4c6e7, 90px 55px #b4c6e7, 95px 55px #b4c6e7, 25px 60px #b4c6e7, 30px 60px #b4c6e7, 35px 60px #b4c6e7, 40px 60px #b4c6e7, 45px 60px #b4c6e7, 50px 60px #b4c6e7, 55px 60px #b4c6e7, 60px 60px #b4c6e7, 65px 60px #b4c6e7, 80px 60px #b4c6e7, 85px 60px #b4c6e7, 90px 60px #b4c6e7, 95px 60px #b4c6e7, 15px 65px #b4c6e7, 20px 65px #b4c6e7, 25px 65px #b4c6e7, 30px 65px #b4c6e7, 90px 65px #b4c6e7, 95px 65px #b4c6e7, 15px 70px #b4c6e7, 20px 70px #b4c6e7, 90px 70px #b4c6e7, 95px 70px #b4c6e7, 35px 65px #8ea9db, 40px 65px #8ea9db, 45px 65px #8ea9db, 50px 65px #8ea9db, 55px 65px #8ea9db, 60px 65px #8ea9db, 65px 65px #8ea9db, 70px 65px #8ea9db, 75px 65px #8ea9db, 35px 70px #8ea9db, 40px 70px #8ea9db, 45px 70px #8ea9db, 50px 70px #8ea9db, 55px 70px #8ea9db, 60px 70px #8ea9db, 65px 70px #8ea9db, 70px 70px #8ea9db, 75px 70px #8ea9db, 80px 70px #8ea9db, 85px 70px #8ea9db, 35px 75px #8ea9db, 40px 75px #8ea9db, 25px 70px #8ea9db, 20px 75px #8ea9db, 25px 75px #8ea9db, 20px 80px #8ea9db, 25px 80px #8ea9db, 30px 80px #8ea9db, 50px 75px #8ea9db, 55px 75px #8ea9db, 65px 75px #8ea9db, 70px 75px #8ea9db, 75px 75px #8ea9db, 80px 75px #8ea9db, 85px 75px #8ea9db, 90px 75px #8ea9db, 45px 80px #8ea9db, 60px 80px #8ea9db, 65px 80px #8ea9db, 70px 80px #8ea9db, 75px 80px #8ea9db, 80px 80px #8ea9db, 85px 80px #8ea9db, 90px 80px #8ea9db, 30px 85px #8ea9db, 35px 85px #8ea9db, 40px 85px #8ea9db, 45px 85px #8ea9db, 50px 85px #8ea9db, 55px 85px #8ea9db, 60px 85px #8ea9db, 65px 85px #8ea9db, 70px 85px #8ea9db, 75px 85px #8ea9db, 80px 85px #8ea9db, 40px 90px #8ea9db, 45px 90px #8ea9db, 50px 90px #8ea9db, 55px 90px #8ea9db, 60px 90px #8ea9db, 65px 90px #8ea9db, 70px 90px #8ea9db, 30px 70px #f8cbad, 30px 75px #f8cbad, 35px 80px #f8cbad, 40px 80px #f8cbad, 45px 75px #f8cbad, 50px 80px #f8cbad, 55px 80px #f8cbad, 60px 75px #f8cbad, 30px 50px #404040, 25px 55px #404040, 30px 55px #404040, 75px 55px #404040, 70px 60px #404040, 75px 60px #404040; } .pixel-orange { height: 115px; width: 95px; position: relative; display: inline-block; margin: 20px; } .pixel-orange::before { content: \"\"; position: absolute; width: 5px; height: 5px; top: -5px; left: -5px; box-shadow: 50px 5px #70ad47, 45px 10px #70ad47, 50px 10px #70ad47, 45px 15px #70ad47, 50px 15px #70ad47, 40px 20px #70ad47, 45px 20px #70ad47, 50px 20px #70ad47, 40px 25px #70ad47, 45px 25px #70ad47, 50px 25px #70ad47, 45px 30px #70ad47, 5px 60px #ed7d31, 5px 65px #ed7d31, 5px 70px #ed7d31, 5px 75px #ed7d31, 10px 50px #ed7d31, 10px 55px #ed7d31, 10px 60px #ed7d31, 10px 75px #ed7d31, 10px 80px #ed7d31, 10px 85px #ed7d31, 15px 40px #ed7d31, 15px 45px #ed7d31, 15px 50px #ed7d31, 15px 85px #ed7d31, 15px 90px #ed7d31, 15px 95px #ed7d31, 20px 35px #ed7d31, 20px 40px #ed7d31, 20px 45px #ed7d31, 20px 95px #ed7d31, 20px 100px #ed7d31, 25px 30px #ed7d31, 25px 35px #ed7d31, 25px 40px #ed7d31, 25px 100px #ed7d31, 25px 105px #ed7d31, 30px 30px #ed7d31, 30px 35px #ed7d31, 30px 105px #ed7d31, 35px 35px #ed7d31, 35px 40px #ed7d31, 35px 105px #ed7d31, 35px 110px #ed7d31, 40px 40px #ed7d31, 40px 105px #ed7d31, 40px 110px #ed7d31, 45px 40px #ed7d31, 45px 105px #ed7d31, 45px 110px #ed7d31, 45px 115px #ed7d31, 50px 30px #ed7d31, 50px 35px #ed7d31, 50px 40px #ed7d31, 50px 100px #ed7d31, 50px 105px #ed7d31, 50px 110px #ed7d31, 50px 115px #ed7d31, 55px 25px #ed7d31, 55px 30px #ed7d31, 55px 35px #ed7d31, 55px 100px #ed7d31, 55px 105px #ed7d31, 55px 110px #ed7d31, 55px 115px #ed7d31, 60px 25px #ed7d31, 60px 30px #ed7d31, 60px 95px #ed7d31, 60px 100px #ed7d31, 60px 105px #ed7d31, 60px 110px #ed7d31, 65px 25px #ed7d31, 65px 30px #ed7d31, 65px 95px #ed7d31, 65px 100px #ed7d31, 65px 105px #ed7d31, 65px 110px #ed7d31, 70px 30px #ed7d31, 70px 35px #ed7d31, 70px 90px #ed7d31, 70px 95px #ed7d31, 70px 100px #ed7d31, 70px 105px #ed7d31, 75px 30px #ed7d31, 75px 35px #ed7d31, 75px 40px #ed7d31, 75px 85px #ed7d31, 75px 90px #ed7d31, 75px 95px #ed7d31, 75px 100px #ed7d31, 75px 105px #ed7d31, 80px 35px #ed7d31, 80px 40px #ed7d31, 80px 45px #ed7d31, 80px 75px #ed7d31, 80px 80px #ed7d31, 80px 85px #ed7d31, 80px 90px #ed7d31, 80px 95px #ed7d31, 80px 100px #ed7d31, 85px 40px #ed7d31, 85px 45px #ed7d31, 85px 50px #ed7d31, 85px 70px #ed7d31, 85px 75px #ed7d31, 85px 80px #ed7d31, 85px 85px #ed7d31, 85px 90px #ed7d31, 85px 95px #ed7d31, 90px 50px #ed7d31, 90px 55px #ed7d31, 90px 60px #ed7d31, 90px 65px #ed7d31, 90px 70px #ed7d31, 90px 75px #ed7d31, 90px 80px #ed7d31, 90px 85px #ed7d31, 25px 10px #833c0c, 25px 15px #833c0c, 30px 20px #833c0c, 30px 25px #833c0c, 35px 25px #833c0c, 35px 30px #833c0c, 40px 30px #833c0c, 40px 35px #833c0c, 45px 35px #833c0c, 95px 60px #ed7d31, 95px 65px #ed7d31, 95px 70px #ed7d31, 95px 75px #ed7d31, 25px 55px #f8cbad, 25px 60px #f8cbad, 25px 65px #f8cbad, 25px 70px #f8cbad, 30px 50px #f8cbad, 30px 55px #f8cbad, 30px 60px #f8cbad, 30px 65px #f8cbad, 60px 35px #f19b61, 65px 35px #f19b61, 50px 40px #f19b61, 55px 40px #f19b61, 60px 40px #f19b61, 65px 40px #f19b61, 70px 40px #f19b61, 30px 40px #f19b61, 25px 45px #f19b61, 30px 45px #f19b61, 35px 45px #f19b61, 40px 45px #f19b61, 45px 45px #f19b61, 50px 45px #f19b61, 55px 45px #f19b61, 60px 45px #f19b61, 65px 45px #f19b61, 70px 45px #f19b61, 75px 45px #f19b61, 20px 50px #f19b61, 40px 50px #f19b61, 45px 50px #f19b61, 50px 50px #f19b61, 55px 50px #f19b61, 60px 50px #f19b61, 65px 50px #f19b61, 70px 50px #f19b61, 75px 50px #f19b61, 80px 50px #f19b61, 15px 55px #f19b61, 15px 60px #f19b61, 15px 65px #f19b61, 15px 70px #f19b61, 15px 75px #f19b61, 15px 80px #f19b61, 10px 65px #f19b61, 10px 70px #f19b61, 50px 55px #f19b61, 55px 55px #f19b61, 60px 55px #f19b61, 65px 55px #f19b61, 70px 55px #f19b61, 75px 55px #f19b61, 80px 55px #f19b61, 85px 55px #f19b61, 55px 60px #f19b61, 60px 60px #f19b61, 65px 60px #f19b61, 70px 60px #f19b61, 75px 60px #f19b61, 80px 60px #f19b61, 85px 60px #f19b61, 60px 65px #f19b61, 65px 65px #f19b61, 70px 65px #f19b61, 75px 65px #f19b61, 80px 65px #f19b61, 85px 65px #f19b61, 60px 70px #f19b61, 65px 70px #f19b61, 70px 70px #f19b61, 75px 70px #f19b61, 80px 70px #f19b61, 55px 75px #f19b61, 60px 75px #f19b61, 65px 75px #f19b61, 70px 75px #f19b61, 75px 75px #f19b61, 45px 80px #f19b61, 50px 80px #f19b61, 55px 80px #f19b61, 60px 80px #f19b61, 65px 80px #f19b61, 70px 80px #f19b61, 75px 80px #f19b61, 40px 85px #f19b61, 45px 85px #f19b61, 50px 85px #f19b61, 55px 85px #f19b61, 60px 85px #f19b61, 65px 85px #f19b61, 70px 85px #f19b61, 20px 80px #f19b61, 20px 85px #f19b61, 20px 90px #f19b61, 25px 85px #f19b61, 25px 90px #f19b61, 25px 95px #f19b61, 30px 90px #f19b61, 35px 90px #f19b61, 40px 90px #f19b61, 45px 90px #f19b61, 50px 90px #f19b61, 55px 90px #f19b61, 60px 90px #f19b61, 65px 90px #f19b61, 30px 95px #f19b61, 35px 95px #f19b61, 40px 95px #f19b61, 45px 95px #f19b61, 50px 95px #f19b61, 55px 95px #f19b61, 30px 100px #f19b61, 35px 100px #f19b61, 40px 100px #f19b61, 45px 100px #f19b61, 25px 50px #f4b084, 35px 50px #f4b084, 20px 55px #f4b084, 20px 60px #f4b084, 20px 65px #f4b084, 20px 70px #f4b084, 20px 75px #f4b084, 35px 55px #f4b084, 40px 55px #f4b084, 45px 55px #f4b084, 35px 60px #f4b084, 40px 60px #f4b084, 45px 60px #f4b084, 50px 60px #f4b084, 35px 65px #f4b084, 40px 65px #f4b084, 45px 65px #f4b084, 50px 65px #f4b084, 55px 65px #f4b084, 30px 70px #f4b084, 35px 70px #f4b084, 40px 70px #f4b084, 45px 70px #f4b084, 50px 70px #f4b084, 55px 70px #f4b084, 25px 75px #f4b084, 30px 75px #f4b084, 35px 75px #f4b084, 40px 75px #f4b084, 45px 75px #f4b084, 50px 75px #f4b084, 25px 80px #f4b084, 30px 80px #f4b084, 35px 80px #f4b084, 40px 80px #f4b084, 45px 80px #f4b084, 30px 85px #f4b084, 35px 85px #f4b084; }"}],"posts":[{"title":"æ„å»ºè‡ªå·±çš„ç®€å•å¾®æœåŠ¡æ¶æ„","slug":"æ„å»ºè‡ªå·±çš„ç®€å•å¾®æœåŠ¡æ¶æ„","date":"2020-07-06T15:36:34.000Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"æ„å»ºè‡ªå·±çš„ç®€å•å¾®æœåŠ¡æ¶æ„.html","link":"","permalink":"https://zcheng.site/%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E7%AE%80%E5%8D%95%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84.html","excerpt":"","text":"æ€»ä½“ä»‹ç»éšç€ä¸šåŠ¡éœ€æ±‚çš„å¿«é€Ÿå‘å±•å˜åŒ–ï¼Œéœ€æ±‚ä¸æ–­å¢é•¿ï¼Œè¿«åˆ‡éœ€è¦ä¸€ç§æ›´åŠ å¿«é€Ÿé«˜æ•ˆçš„è½¯ä»¶äº¤ä»˜æ–¹å¼ã€‚å¾®æœåŠ¡å¯ä»¥å¼¥è¡¥å•ä½“åº”ç”¨ä¸è¶³ï¼Œæ˜¯ä¸€ç§æ›´åŠ å¿«é€Ÿé«˜æ•ˆè½¯ä»¶æ¶æ„é£æ ¼ã€‚å•ä½“åº”ç”¨è¢«åˆ†è§£æˆå¤šä¸ªæ›´å°çš„æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡æœ‰è‡ªå·±çš„ç‹¬ç«‹æ¨¡å—ï¼Œå•ç‹¬éƒ¨ç½²ï¼Œç„¶åå…±åŒç»„æˆä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚æŠŠèŒƒå›´é™å®šåˆ°å•ä¸ªç‹¬ç«‹ä¸šåŠ¡æ¨¡å—åŠŸèƒ½ã€‚åˆ†å¸ƒå¼éƒ¨ç½²åœ¨å„å°æœåŠ¡å™¨ä¸Šã€‚æœ¬ç¯‡æˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨.NET Coreæ‰“é€ è‡ªå·±çš„å¾®æœåŠ¡æ¶æ„ã€‚ æ³¨æ„ï¼šå¾®æœåŠ¡æ¶æ„ä¸æ˜¯ä¸‡èƒ½è¯ï¼Œæœ¬ç¯‡ä»…ä¾›å‚è€ƒå’Œæ¢è®¨ã€‚å¯¹äºå¤§éƒ¨åˆ†å°é¡¹ç›®æ¥è¯´ï¼Œè¯·ä¸è¦ä¸ºäº†å¾®æœåŠ¡è€Œå¾®æœåŠ¡ã€‚æ¯•ç«ŸæŠ€æœ¯ä¸æ˜¯ä¸‡èƒ½çš„ï¼ŒæŠ€æœ¯æ˜¯ä¸ºä¸šåŠ¡æœåŠ¡çš„ã€‚ å¾®æœåŠ¡æ¶æ„çš„å¥½å¤„ å•ä¸ªæœåŠ¡å¾ˆå®¹æ˜“å¼€å‘ã€ç†è§£å’Œç»´æŠ¤ã€‚ æ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥æœ‰ä¸“é—¨å¼€å‘å›¢é˜Ÿæ¥å¼€å‘ã€‚ æ¯ä¸ªå¾®æœåŠ¡ç‹¬ç«‹çš„éƒ¨ç½²ã€‚ æ¯ä¸ªæœåŠ¡ç‹¬ç«‹æ‰©å±•ã€‚ å¾®æœåŠ¡æ¶æ„çš„ä¸è¶³ï¼ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°æœåŠ¡å‘ç°ï¼‰ å¾®æœåŠ¡åº”ç”¨æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç”±æ­¤ä¼šå¸¦æ¥å›ºæœ‰çš„å¤æ‚æ€§ã€‚ æœåŠ¡åœ°å€ç›®å½•ï¼ŒæœåŠ¡å¥åº·åº¦ï¼Œéƒ¨ç½²å›°éš¾ï¼ŒæœåŠ¡ä¾èµ–é—®é¢˜ï¼Œæ•°æ®åº“åˆ†åŒºé—®é¢˜ã€‚ ä¼ ç»Ÿæ¨¡å¼ Ocelotï¼ˆç½‘å…³ï¼‰æ¨¡å¼ é›†æˆIdentityServiceï¼ˆè®¤è¯ï¼‰ é›†æˆconsulï¼ˆæœåŠ¡å‘ç°ï¼‰ æ­å»ºä¸€ä¸ªç®€å•çš„å¾®æœåŠ¡æ¶æ„OcelotOcelot æ˜¯ä¸€ä¸ªä»…é€‚ç”¨äº .Net Core çš„ç½‘å…³ç»„ä»¶ã€‚Ocelotä¸­é—´ä»¶ä½¿ç”¨éå¸¸ç®€å•ï¼Œéš¾çš„ç‚¹åœ¨äºå¦‚ä½•å»é…ç½®ã€‚å®ƒçš„åŠŸèƒ½åŒ…æ‹¬äº†ï¼šè·¯ç”±ã€è¯·æ±‚èšåˆã€æœåŠ¡å‘ç°ã€è®¤è¯ã€é‰´æƒã€é™æµç†”æ–­ã€å¹¶å†…ç½®äº†è´Ÿè½½å‡è¡¡å™¨ç­‰çš„é›†æˆï¼Œè€Œè¿™äº›åŠŸèƒ½éƒ½æ˜¯é€šè¿‡é…ç½®å®ç°ã€‚ Ocelotçš„å¼€æºåœ°å€ï¼šhttps://github.com/ThreeMammals/Ocelot Ocelotå®˜ç½‘åœ°å€ï¼šhttps://ocelot.readthedocs.io/en/latest/index.html åŸºæœ¬é›†æˆ æ·»åŠ Ocelotæ–°å»ºä¸€ä¸ª .Net core 2.2 web é¡¹ç›®ï¼ˆApiGatewayï¼‰ï¼Œæ·»åŠ ä»¥ä¸‹NugetåŒ…ï¼š Ocelot Ocelot.Administration Ocelotæ”¯æŒåœ¨è¿è¡Œæ—¶é€šè¿‡ç»è¿‡èº«ä»½éªŒè¯çš„HTTPAPIæ›´æ”¹é…ç½®ã€‚è¿™å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼è¿›è¡Œèº«ä»½éªŒè¯ï¼šä½¿ç”¨Ocelotçš„å†…éƒ¨IdentityServerï¼ˆä»…ç”¨äºéªŒè¯å¯¹ç®¡ç†APIçš„è¯·æ±‚ï¼‰æˆ–å°†ç®¡ç†APIèº«ä»½éªŒè¯æŒ‚é’©åˆ°æ‚¨è‡ªå·±çš„IdentityServerä¸­ã€‚ Ocelot.Cache.CacheManager CacheManager.Netæ‰©å±•åŒ… Ocelot.Provider.Polly Polly.NETæ‰©å±•åŒ… åœ¨é¡¹ç›®æ ¹ç›®å½•æ·»åŠ ocelot.jsonï¼Œåå­—å¯ä»¥è‡ªå–ã€‚ å‰é¢è¯´äº†ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½æ˜¯é€šè¿‡é…ç½®å®ç°çš„ï¼Œæ‰€ä»¥é…ç½®ä¹Ÿç›¸å¯¹å¤æ‚ã€‚é…ç½®æœ‰ä¸¤ä¸ªéƒ¨åˆ†ã€‚ä¸€ç»„ReRouteså’Œä¸€ä¸ªGlobalConfigurationã€‚ReRoutesæ˜¯å‘Šè¯‰Ocelotå¦‚ä½•å¤„ç†ä¸Šæ¸¸è¯·æ±‚çš„å¯¹è±¡ã€‚GlobalConfigurationé¡¾åæ€ä¹‰æ˜¯å…¨å±€é…ç½®ï¼Œå…·ä½“é…ç½®è¯·æŸ¥çœ‹å®˜ç½‘ã€‚ä¸‹é¢åˆ—ä¸¾ç®€å•é…ç½® 1234567891011121314151617181920212223242526272829&#123; &quot;GlobalConfiguration&quot;: &#123; //å¤–éƒ¨è®¿é—®è·¯å¾„ &quot;BaseUrl&quot;: &quot;http://localhost:13000&quot;, //é™é€Ÿé…ç½® &quot;RateLimitOptions&quot;: &#123; //ç™½åå• &quot;ClientWhitelist&quot;: [], &quot;EnableRateLimiting&quot;: true, //é™åˆ¶æ—¶é—´æ®µï¼Œä¾‹å¦‚1sï¼Œ5mï¼Œ1hï¼Œ1d &quot;Period&quot;: &quot;1s&quot;, //é‡è¯•ç­‰å¾…çš„æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰ &quot;PeriodTimespan&quot;: 1, //é™åˆ¶ &quot;Limit&quot;: 1, //è‡ªå®šä¹‰æ¶ˆæ¯ &quot;QuotaExceededMessage&quot;: &quot;å•ä½æ—¶é—´å†…è¯·æ±‚æ¬¡æ•°è¶…è¿‡é™åˆ¶ï¼&quot;, &quot;HttpStatusCode&quot;: 999 &#125;, //ç†”æ–­é…ç½® &quot;QoSOptions&quot;: &#123; &quot;ExceptionsAllowedBeforeBreaking&quot;: 3, &quot;DurationOfBreak&quot;: 5, //è¶…æ—¶å€¼(æ¯«ç§’) &quot;TimeoutValue&quot;: 5000 &#125; &#125;, &quot;ReRoutes&quot;: []&#125; é…ç½®æ–‡ä»¶åˆå§‹åŒ–å¥½ä¹‹åï¼Œéœ€è¦åœ¨Program.csæ–‡ä»¶ä¸­åŠ è½½JSONé…ç½®ï¼ŒOcelotæ”¯æŒæ ¹æ®ç¯å¢ƒå˜é‡ä½¿ç”¨é…ç½®æ–‡ä»¶ã€‚ 1234567891011121314151617181920212223242526272829303132333435public class Program&#123; public static void Main(string[] args) &#123; CreateWebHostBuilder(args).Build().Run(); &#125; public static IWebHostBuilder CreateWebHostBuilder(string[] args) =&gt; new WebHostBuilder() .UseKestrel((context, opt) =&gt; &#123; opt.AddServerHeader = false; ////ä»é…ç½®æ–‡ä»¶è¯»å–é…ç½® //opt.Configure(context.Configuration.GetSection(&quot;Kestrel&quot;)); &#125;) .UseContentRoot(Directory.GetCurrentDirectory()) .ConfigureAppConfiguration((hostingContext, config) =&gt; &#123; var env = hostingContext.HostingEnvironment; //æ ¹æ®ç¯å¢ƒå˜é‡åŠ è½½ä¸åŒçš„JSONé…ç½® config.AddJsonFile(&quot;appsettings.json&quot;, optional: true, reloadOnChange: true) .AddJsonFile($&quot;appsettings.&#123;env.EnvironmentName&#125;.json&quot;, optional: true, reloadOnChange: true) .AddJsonFile(&quot;ocelot.json&quot;) .AddEnvironmentVariables(); //ä»ç¯å¢ƒå˜é‡æ·»åŠ é…ç½® &#125;) .UseIISIntegration() .ConfigureLogging((hostingContext, logging) =&gt; &#123; logging.AddConfiguration(hostingContext.Configuration.GetSection(&quot;Logging&quot;)); //æ·»åŠ æ§åˆ¶å°æ—¥å¿—,Dockerç¯å¢ƒä¸‹è¯·åŠ¡å¿…å¯ç”¨ logging.AddConsole(); //æ·»åŠ è°ƒè¯•æ—¥å¿— logging.AddDebug(); &#125;) .UseStartup&lt;Startup&gt;();&#125; ç„¶ååœ¨Startup.csæ–‡ä»¶ConfigureServicesæ–¹æ³•ä¸­æ³¨å†ŒæœåŠ¡æ—¶ä½¿ç”¨AddOcelot()ï¼ŒConfigureæ–¹æ³•ä¸­ä½¿ç”¨app.UseOcelot().Wait(); è¿™æ ·ç½‘å…³çš„é…ç½®å°±å®Œæˆäº†ã€‚ 123services.AddOcelot(Configuration)app.UseOcelot().Wait(); æ·»åŠ æµ‹è¯•APIé¡¹ç›®æ–°å»ºä¸¤ä¸ª .Net core 2.2 webé¡¹ç›®ï¼ˆvs è‡ªå»ºçš„é‚£ç§å°±OKï¼‰ï¼Œå¹¶ä½¿ç”¨Swaggeræ¥åšæ¥å£è¯´æ˜ã€‚ Nuget æ·»åŠ  Swashbuckle.AspNetCore å’ŒMicrosoft.Extensions.PlatformAbstractions å®ç°Swagger uiï¼Œä»£ç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829public void ConfigureServices(IServiceCollection services)&#123; services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2); services.AddSwaggerGen(options =&gt; &#123; options.SwaggerDoc(&quot;SwaggerAPI1&quot;, new Info &#123; Title = &quot;API1&quot;, Version = &quot;v1&quot; &#125;); var basePath = PlatformServices.Default.Application.ApplicationBasePath; var xmlPath = Path.Combine(basePath, &quot;Services.Test1.xml&quot;); options.IncludeXmlComments(xmlPath); &#125;); //æœåŠ¡æ³¨å†Œ //services.Configure&lt;ServiceRegistrationOptions&gt;&#125;// This method gets called by the runtime. Use this method to configure the HTTP request pipeline.public void Configure(IApplicationBuilder app, IHostingEnvironment env)&#123; if (env.IsDevelopment()) &#123; app.UseDeveloperExceptionPage(); &#125; app.UseSwagger(c =&gt; &#123; c.RouteTemplate = &quot;&#123;documentName&#125;/swagger.json&quot;; &#125;); app.UseSwaggerUI(c =&gt; &#123; c.SwaggerEndpoint(&quot;/SwaggerAPI1/swagger.json&quot;, &quot;API1&quot;); &#125;); app.UseMvc();&#125; é¡¹ç›®.csprojæ–‡ä»¶ä¸­è®¾ç½®XMLæ–‡æ¡£è¾“å‡ºè·¯å¾„ Services.Test1 å’Œ Services.Test2ä¸€æ ·çš„é…ç½®ï¼Œç•¥è¿‡ã€‚ç¼–è¯‘å¯åŠ¨ï¼Œé¡µé¢å¦‚ä¸‹ï¼Œæ¥å£é…ç½®å®Œæˆã€‚ é…ç½®é¡¹ç›®çš„ä¸Šæ¸¸è¯·æ±‚å¯¹è±¡ï¼ˆocelot.jsonï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&quot;ReRoutes&quot;: [ //API1é¡¹ç›®é…ç½® &#123; &quot;UpstreamPathTemplate&quot;: &quot;/gateway/1/&#123;url&#125;&quot;, &quot;UpstreamHttpMethod&quot;: [ &quot;Get&quot;, &quot;Post&quot;, &quot;Delete&quot;, &quot;Put&quot; ], &quot;DownstreamPathTemplate&quot;: &quot;/api1/&#123;url&#125;&quot;, &quot;DownstreamScheme&quot;: &quot;http&quot;, &quot;ServiceName&quot;: &quot;API1&quot;, &quot;UseServiceDiscovery&quot;: true, &quot;LoadBalancer&quot;: &quot;RoundRobin&quot;, &quot;DownstreamHostAndPorts&quot;: [ &#123; &quot;Host&quot;: &quot;119.29.50.115&quot;, &quot;Port&quot;: 80 &#125;, &#123; &quot;Host&quot;: &quot;localhost&quot;, &quot;Port&quot;: 13001 &#125; ], &quot;QoSOptions&quot;: &#123; &quot;ExceptionsAllowedBeforeBreaking&quot;: 3, &quot;DurationOfBreak&quot;: 10, &quot;TimeoutValue&quot;: 5000 &#125; //&quot;AuthenticationOptions&quot;: &#123; // &quot;AuthenticationProviderKey&quot;: &quot;Bearer&quot;, // &quot;AllowedScopes&quot;: [ // ] //&#125; &#125;, //API2é¡¹ç›®é…ç½® &#123; &quot;UpstreamPathTemplate&quot;: &quot;/gateway/2/&#123;url&#125;&quot;, &quot;UpstreamHttpMethod&quot;: [ &quot;Get&quot;, &quot;Post&quot;, &quot;Delete&quot;, &quot;Put&quot; ], &quot;DownstreamPathTemplate&quot;: &quot;/api2/&#123;url&#125;&quot;, &quot;DownstreamScheme&quot;: &quot;http&quot;, &quot;ServiceName&quot;: &quot;API2&quot;, &quot;UseServiceDiscovery&quot;: true, &quot;LoadBalancer&quot;: &quot;RoundRobin&quot;, &quot;DownstreamHostAndPorts&quot;: [ &#123; &quot;Host&quot;: &quot;111.230.160.62&quot;, &quot;Port&quot;: 80 &#125;, &#123; &quot;Host&quot;: &quot;localhost&quot;, &quot;Port&quot;: 13002 &#125; ], &quot;QoSOptions&quot;: &#123; &quot;ExceptionsAllowedBeforeBreaking&quot;: 3, &quot;DurationOfBreak&quot;: 10, &quot;TimeoutValue&quot;: 5000 &#125; //&quot;AuthenticationOptions&quot;: &#123; // &quot;AuthenticationProviderKey&quot;: &quot;Bearer&quot;, // &quot;AllowedScopes&quot;: [ // ] //&#125; &#125;,] ReRoutes APIå¯¹è±¡æ¨¡æ¿é…ç½®èŠ‚ç‚¹è§£é‡Šå¦‚ä¸‹ï¼š UpstreamPathTemplate ä¸Šæ¸¸è·¯å¾„æ¨¡æ¿ UpstreamHttpMethod ä¸Šæ¸¸HTTPè¯·æ±‚æ–¹æ³• DownstreamPathTemplate ä¸‹æ¸¸è·¯å¾„æ¨¡æ¿ DownstreamScheme ä¸‹æ¸¸åè®®Https/Http DownstreamHostAndPorts ä¸‹æ¸¸ä¸»æœºå’Œç«¯å£å·ï¼Œå…è®¸é…ç½®å¤šä¸ª UseServiceDiscovery æ˜¯å¦ä½¿ç”¨æœåŠ¡å‘ç°ï¼ˆTrue/Falseï¼‰ ServiceName æœåŠ¡åç§°ï¼ˆç»“åˆæœåŠ¡å‘ç°ä½¿ç”¨ï¼‰ LoadBalancer æŒ‡å®šä¸€ä¸ªè´Ÿè½½å‡è¡¡ç®—æ³•ï¼š RoundRobinï¼šè½®è¯¢ LeastConnectionï¼šæœ€å°‘è¿æ¥æ•° NoLoadBalancerï¼šä¸é€‚ç”¨è´Ÿè½½å‡è¡¡ LoadBalancerOptions è´Ÿè½½å‡è¡¡å™¨é…ç½® QoSOptions ç†”æ–­é…ç½®ï¼Œåœ¨è¯·æ±‚å‘ä¸‹æ¸¸æœåŠ¡æ—¶ä½¿ç”¨æ–­è·¯ AuthenticationOptions æƒé™é…ç½® å¯åŠ¨ç»“æœå¯åŠ¨webé¡¹ç›®ï¼Œwebé¡µé¢æŠ¥é”™ï¼Œä½†æ— å¦¨ï¼Œä½¿ç”¨PostManè¯·æ±‚ç½‘å…³æ¥å£è®¿é—®api1/TestOnesæˆåŠŸã€‚ èšåˆAPIæ–‡æ¡£ï¼ˆSwaggerUIï¼‰å‰é¢é…ç½®äº†ç½‘å…³æ¥å£ä¸Šæ¸¸ï¼Œä½†æ˜¯é¡µé¢Swaggeræ²¡æœ‰æ˜¾ç¤ºï¼Œè¿™èŠ‚ä¸»è¦æ˜¯æ•´åˆSwaggerUIã€‚ é¦–å…ˆéœ€è¦é…ç½®ApiGatewayé¡¹ç›®çš„Swaggerï¼Œåœ¨é…ç½®æ–‡ä»¶é…ç½®ä¸Šé¢ä¸¤ä¸ªæ¥å£çš„SwaggerNamesï¼Œä»£ç ä¸­éå†æ·»åŠ åˆ°ç½‘å…³é¡¹ç›®çš„SwaggerUIä¸­,ä»£ç å¦‚ä¸‹ ConfigureServices1234services.AddSwaggerGen(options =&gt;&#123; options.SwaggerDoc(Configuration[&quot;Swagger:Name&quot;], new Info &#123; Title = Configuration[&quot;Swagger:Title&quot;], Version = Configuration[&quot;Swagger:Version&quot;] &#125;);&#125;); Configure12345678910111213141516171819public void Configure(IApplicationBuilder app, IHostingEnvironment env)&#123; var apis = Configuration[&quot;Apis:SwaggerNames&quot;].Split(&quot;;&quot;).ToList(); if (env.IsDevelopment()) &#123; app.UseDeveloperExceptionPage(); &#125; app.UseMvc() .UseSwagger() .UseSwaggerUI(options =&gt; &#123; apis.ToList().ForEach(key =&gt; &#123; options.SwaggerEndpoint($&quot;/&#123;key&#125;/swagger.json&quot;, key); &#125;); options.DocumentTitle = &quot;ç½‘å…³&quot;; &#125;); app.UseOcelot().Wait();&#125; appsettings.json12345678&quot;Swagger&quot;: &#123; &quot;Name&quot;: &quot;ApiGateway&quot;, &quot;Title&quot;: &quot;ç½‘å…³æœåŠ¡&quot;, &quot;Version&quot;: &quot;v1&quot;&#125;,&quot;Apis&quot;: &#123; &quot;SwaggerNames&quot;: &quot;SwaggerAPI1;SwaggerAPI2&quot;&#125; PS:SwaggerAPI1ã€SwaggerAPI2æ˜¯å‰é¢ä¸¤ä¸ªæ¥å£çš„SwaggerNameï¼Œè¿™é‡Œéœ€è¦å¯¹åº”ä¸Šã€‚ é…ç½®Swaggerçš„ä¸Šæ¸¸è¯·æ±‚å¯¹è±¡ï¼ˆocelot.jsonï¼‰12345678910111213141516171819202122232425262728293031323334//swagger API1é…ç½®&#123; &quot;DownstreamPathTemplate&quot;: &quot;/SwaggerAPI1/swagger.json&quot;, &quot;DownstreamScheme&quot;: &quot;http&quot;, &quot;UpstreamPathTemplate&quot;: &quot;/SwaggerAPI1/swagger.json&quot;, &quot;UpstreamHttpMethod&quot;: [ &quot;GET&quot;, &quot;POST&quot;, &quot;DELETE&quot;, &quot;PUT&quot; ], &quot;DownstreamHostAndPorts&quot;: [ &#123; &quot;Host&quot;: &quot;119.29.50.115&quot;, &quot;Port&quot;: 80 &#125;, &#123; &quot;Host&quot;: &quot;localhost&quot;, &quot;Port&quot;: 13001 &#125; ]&#125;,//swagger API2é…ç½®&#123; &quot;DownstreamPathTemplate&quot;: &quot;/SwaggerAPI2/swagger.json&quot;, &quot;DownstreamScheme&quot;: &quot;http&quot;, &quot;UpstreamPathTemplate&quot;: &quot;/SwaggerAPI2/swagger.json&quot;, &quot;UpstreamHttpMethod&quot;: [ &quot;GET&quot;, &quot;POST&quot;, &quot;DELETE&quot;, &quot;PUT&quot; ], &quot;DownstreamHostAndPorts&quot;: [ &#123; &quot;Host&quot;: &quot;111.230.160.62&quot;, &quot;Port&quot;: 80 &#125;, &#123; &quot;Host&quot;: &quot;localhost&quot;, &quot;Port&quot;: 13002 &#125; ]&#125; å¯åŠ¨ç»“æœä½¿ç”¨SwaggerUIæ•´åˆäº†API1å’ŒAPI2çš„æ¥å£æ–‡æ¡£ã€‚ IdentityServer é›†æˆå®˜ç½‘æ–‡æ¡£åœ°å€ï¼šhttp://docs.identityserver.io/en/latest/index.html IdentityServer4æ˜¯ä¸€ä¸ªåŸºäºOpenID Connectå’Œ OAuth 2.0çš„é’ˆå¯¹ ASP .NET Core 2.0çš„æ¡†æ¶ã€‚ IdentityServeræ˜¯å°†è§„èŒƒå…¼å®¹çš„OpenID Connectå’ŒOAuth 2.0ç»ˆç»“ç‚¹æ·»åŠ åˆ°ä»»æ„ASP .NETCoreåº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶ã€‚ä½ æ„å»ºåŒ…å«ç™»å½•å’Œæ³¨é”€é¡µé¢çš„åº”ç”¨ç¨‹åºï¼ŒIdentityServerä¸­é—´ä»¶ä¼šå‘å…¶æ·»åŠ å¿…è¦çš„åè®®å¤´ï¼Œä»¥ä¾¿å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨è¿™äº›æ ‡å‡†åè®®ä¸å…¶å¯¹è¯ã€‚ æ·»åŠ æˆæƒæœåŠ¡é¡¹ç›®æ–°å»º .Net core 2.2 webé¡¹ç›®ï¼Œæ·»åŠ ä»¥ä¸‹NugetåŒ…ï¼š IdentityServer4.AspNetIdentity IdentityServer4.EntityFramework ä½¿ç”¨æ•°æ®å­˜å‚¨æœºåˆ¶ é…ç½®appsetting.jsoné…ç½®æµ‹è¯•ç¯å¢ƒä¸‹çš„å®¢æœç«¯ä¿¡æ¯å’ŒIdentity APIèµ„æºé…ç½®ï¼Œå…·ä½“é…ç½®éœ€è¦æŒ‰ç…§è‡ªå·±çš„é€»è¾‘å®šä¹‰ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†ç»“åˆæˆ‘ä¸‹é¢çš„IdentityServerConfigæ–‡ä»¶æ‰€å®šä¹‰ï¼Œä»£ç å¦‚ä¸‹ï¼Œ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647ä¸ºäº†ç»“åˆæˆ‘ä¸‹é¢çš„IdentityServerConfigæ–‡ä»¶æ‰€å®šä¹‰ï¼Œä»£ç å¦‚ä¸‹ï¼Œ&quot;IdentityServer&quot;: &#123; &quot;ApiName&quot;: &quot;default-api&quot;, &quot;ApiSecret&quot;: &quot;secret&quot;, &quot;Clients&quot;: [ &#123; &quot;ClientId&quot;: &quot;client&quot;, &quot;AllowedGrantTypes&quot;: [ &quot;password&quot; ], &quot;ClientSecrets&quot;: [ &#123; &quot;Value&quot;: &quot;def2edf7-5d42-4edc-a84a-30136c340e13&quot; &#125; ], &quot;AllowedScopes&quot;: [ &quot;default-api&quot; ] &#125;, &#123; &quot;ClientId&quot;: &quot;demo&quot;, &quot;ClientName&quot;: &quot;MVC Client Demo&quot;, &quot;AllowedGrantTypes&quot;: [ &quot;hybrid&quot;, &quot;client_credentials&quot; ], &quot;RequireConsent&quot;: &quot;true&quot;, &quot;ClientSecrets&quot;: [ &#123; &quot;Value&quot;: &quot;def2edf7-5d42-4edc-a84a-30136c340e13&quot; &#125; ], &quot;RedirectUris&quot;: [ &quot;http://openidclientdemo.com:8001/signin-oidc&quot; ], &quot;PostLogoutRedirectUris&quot;: [ &quot;http://openidclientdemo.com:8001/signout-callback-oidc&quot; ], &quot;AllowedScopes&quot;: [ &quot;openid&quot;, &quot;profile&quot;, &quot;default-api&quot; ], &quot;AllowOfflineAccess&quot;: &quot;true&quot; &#125; ] &#125; æ·»åŠ IdentityServerConfigç±»IdentityServerConfig ç±»åˆ†ä¸ºä¸‰ä¸ªæ–¹æ³•ï¼š å®šä¹‰APIèµ„æºï¼š1234567891011public static IEnumerable&lt;ApiResource&gt; GetApiResources()&#123; return new List&lt;ApiResource&gt; &#123; new ApiResource(&quot;default-api&quot;, &quot;Default (all) API&quot;) &#123; Description = &quot;AllFunctionalityYouHaveInTheApplication&quot;, ApiSecrets= &#123;new Secret(&quot;secret&quot;) &#125; &#125; &#125;;&#125; å®šä¹‰èº«ä»½èµ„æºï¼š1234567891011public static IEnumerable&lt;IdentityResource&gt; GetIdentityResources()&#123; return new List&lt;IdentityResource&gt; &#123; new IdentityResources.OpenId(), new IdentityResources.Profile(), new IdentityResources.Email(), new IdentityResources.Phone(), new IdentityResources.Address() &#125;;&#125; 1234567891011121314public static IEnumerable&lt;IdentityResource&gt; GetIdentityResources()&#123; var customProfile = new IdentityResource( name: &quot;custom.profile&quot;, displayName: &quot;Custom profile&quot;, claimTypes: new[] &#123; &quot;name&quot;, &quot;email&quot;, &quot;status&quot; &#125;); return new List&lt;IdentityResource&gt; &#123; new IdentityResources.OpenId(), new IdentityResources.Profile(), customProfile &#125;;&#125; IdentityResource å…·ä½“å±æ€§ Enabled æŒ‡ç¤ºæ­¤èµ„æºæ˜¯å¦å·²å¯ç”¨ä¸”å¯ä»¥è¯·æ±‚ã€‚é»˜è®¤ä¸ºtrueã€‚ Name æ ‡è¯†èµ„æºçš„å”¯ä¸€åç§°ã€‚è¿™æ˜¯å®¢æˆ·ç«¯å°†ç”¨äºæˆæƒè¯·æ±‚ä¸­çš„scopeå‚æ•°çš„å€¼ã€‚ DisplayName æ˜¾ç¤ºåç§°ã€‚ Description æè¿°ã€‚ Required é»˜è®¤ä¸ºfalseã€‚ï¼ˆæš‚æœªæ·±ç©¶ç†è§£ï¼‰ Emphasize é»˜è®¤ä¸ºfalseã€‚ï¼ˆæš‚æœªæ·±ç©¶ç†è§£ï¼‰ ShowInDiscoveryDocument æŒ‡å®šæ­¤èŒƒå›´æ˜¯å¦æ˜¾ç¤ºåœ¨å‘ç°æ–‡æ¡£ä¸­ã€‚é»˜è®¤ä¸ºtrueã€‚ UserClaims åº”åŒ…å«åœ¨èº«ä»½ä»¤ç‰Œä¸­çš„å…³è”ç”¨æˆ·å£°æ˜ç±»å‹çš„åˆ—è¡¨ã€‚ å®šä¹‰æµ‹è¯•å®¢æœç«¯æ­¤å¤„åˆ™æ˜¯é€šè¿‡appsetting.json æ–‡ä»¶è·å–é…ç½® 12345678910111213141516171819202122public static IEnumerable&lt;Client&gt; GetClients(IConfiguration configuration)&#123; var clients = new List&lt;Client&gt;(); foreach (var child in configuration.GetSection(&quot;IdentityServer:Clients&quot;).GetChildren()) &#123; clients.Add(new Client &#123; ClientId = child[&quot;ClientId&quot;], ClientName = child[&quot;ClientName&quot;], AllowedGrantTypes = child.GetSection(&quot;AllowedGrantTypes&quot;).GetChildren().Select(c =&gt; c.Value).ToArray(), RequireConsent = bool.Parse(child[&quot;RequireConsent&quot;] ?? &quot;false&quot;), AllowOfflineAccess = bool.Parse(child[&quot;AllowOfflineAccess&quot;] ?? &quot;false&quot;), ClientSecrets = child.GetSection(&quot;ClientSecrets&quot;).GetChildren().Select(secret =&gt; new Secret(secret[&quot;Value&quot;].Sha256())).ToArray(), AllowedScopes = child.GetSection(&quot;AllowedScopes&quot;).GetChildren().Select(c =&gt; c.Value).ToArray(), RedirectUris = child.GetSection(&quot;RedirectUris&quot;).GetChildren().Select(c =&gt; c.Value).ToArray(), PostLogoutRedirectUris = child.GetSection(&quot;PostLogoutRedirectUris&quot;).GetChildren().Select(c =&gt; c.Value).ToArray(), &#125;); &#125; return clients;&#125; é…ç½®StartupConfigureServicesè¿™é‡Œåªæ˜¯ç”¨ä½œæµ‹è¯•ï¼Œæ‰€ä»¥æ²¡æœ‰åœ¨æ•°æ®åº“ä¸­è¯»å–é…ç½®ï¼Œè€Œæ˜¯åœ¨å†…å­˜ä¸­è·å–ã€‚ç›¸åº”çš„æ•°æ®åº“è¯»å–æ–¹æ³•ä¹Ÿæœ‰è¯´æ˜ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940public void ConfigureServices(IServiceCollection services)&#123; //var connectionString = Configuration.GetConnectionString(&quot;Default&quot;); //services.AddDbContext&lt;MagicodesAdminContext&gt;(options =&gt; options.UseSqlServer(connectionString)); //services.AddIdentity&lt;AbpUsers, AbpRoles&gt;() // .AddEntityFrameworkStores&lt;MagicodesAdminContext&gt;() // .AddDefaultTokenProviders(); services.AddIdentityServer() .AddDeveloperSigningCredential() .AddInMemoryPersistedGrants() .AddInMemoryIdentityResources(IdentityServerConfig.GetIdentityResources()) .AddInMemoryApiResources(IdentityServerConfig.GetApiResources()) .AddInMemoryClients(IdentityServerConfig.GetClients(Configuration)) //.AddAspNetIdentity&lt;AbpUsers&gt;() //ä»æ•°æ®åº“è¯»å–é…ç½®ç­‰å†…å®¹(clients, resources) //.AddConfigurationStore(options =&gt; //&#123; // options.ConfigureDbContext = b =&gt; // b.UseSqlServer(connectionString); //&#125;) // this adds the operational data from DB (codes, tokens, consents) //.AddOperationalStore(options =&gt; //&#123; // options.ConfigureDbContext = b =&gt; // b.UseSqlServer(connectionString); // options.PersistedGrants.Name = &quot;AbpPersistedGrants&quot;; // //options.DeviceFlowCodes.Name = // // this enables automatic token cleanup. this is optional. // options.EnableTokenCleanup = true; //&#125;); //.AddAspNetIdentity() //.AddAbpPersistedGrants&lt;AdminDbContext&gt;() //.AddAbpIdentityServer&lt;User&gt;(); ;&#125; Configure123456789public void Configure(IApplicationBuilder app, IHostingEnvironment env)&#123; if (env.IsDevelopment()) &#123; app.UseDeveloperExceptionPage(); &#125; app.UseIdentityServer();&#125; å¯åŠ¨ç»“æœå°±è¿™æ ·å¯ä»¥å¯åŠ¨æœåŠ¡äº†ï¼Œæµè§ˆå™¨å¯åŠ¨ä¼šæ˜¾ç¤ºå¦‚ä¸‹é¡µé¢ï¼Œå› ä¸ºæ²¡æœ‰ä»»ä½•é¡µé¢å¯åŠ¨ï¼Œæ‰€ä¸ºæ˜¾ç¤ºä¸º404ã€‚ ä½†æ— å¦¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨PostMan è®¿é—®ï¼š http://localhost:13004/.well-known/openid-configuration ä½ ä¼šçœ‹åˆ°å®˜æ–¹æ‰€è°“çš„å‘ç°æ–‡æ¡£ã€‚å®¢æˆ·ç«¯å’ŒAPIå°†ä½¿ç”¨å®ƒæ¥ä¸‹è½½å¿…è¦çš„é…ç½®æ•°æ®ã€‚åˆ°æ­¤ä¸ºæ­¢IdentityServeræœåŠ¡å·²ç»æ­å»ºæˆåŠŸï¼ é¦–æ¬¡å¯åŠ¨æ—¶ï¼ŒIdentityServerå°†ä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªå¼€å‘äººå‘˜ç­¾åå¯†é’¥ï¼Œå®ƒæ˜¯ä¸€ä¸ªåä¸ºçš„æ–‡ä»¶ã€‚æ‚¨ä¸å¿…å°†è¯¥æ–‡ä»¶æ£€å…¥æºä»£ç ç®¡ç†ä¸­ï¼Œå¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°†é‡æ–°åˆ›å»ºè¯¥æ–‡ä»¶ã€‚tempkey.rsa é…ç½®ApiGatewayç½‘å…³é¡¹ç›®åœ¨å‰é¢Ocelotç« èŠ‚ä¸­ï¼Œé…ç½®äº†ocelot.jsonï¼Œè¿™é‡Œç»§ç»­ä¿®æ”¹ocelot.jsonæ–‡ä»¶ï¼Œå¯ç”¨æƒé™è®¤è¯ 12345678910111213141516171819202122232425262728293031&#123; &quot;UpstreamPathTemplate&quot;: &quot;/gateway/1/&#123;url&#125;&quot;, &quot;UpstreamHttpMethod&quot;: [ &quot;Get&quot;, &quot;Post&quot;, &quot;Delete&quot;, &quot;Put&quot; ], &quot;DownstreamPathTemplate&quot;: &quot;/api1/&#123;url&#125;&quot;, &quot;DownstreamScheme&quot;: &quot;http&quot;, &quot;ServiceName&quot;: &quot;API1&quot;, &quot;UseServiceDiscovery&quot;: true, &quot;LoadBalancer&quot;: &quot;RoundRobin&quot;, &quot;DownstreamHostAndPorts&quot;: [ &#123; &quot;Host&quot;: &quot;119.29.50.115&quot;, &quot;Port&quot;: 80 &#125;, &#123; &quot;Host&quot;: &quot;localhost&quot;, &quot;Port&quot;: 13001 &#125; ], &quot;QoSOptions&quot;: &#123; &quot;ExceptionsAllowedBeforeBreaking&quot;: 3, &quot;DurationOfBreak&quot;: 10, &quot;TimeoutValue&quot;: 5000 &#125; //å¯ç”¨æƒé™è®¤è¯ &quot;AuthenticationOptions&quot;: &#123; &quot;AuthenticationProviderKey&quot;: &quot;IdentityBearer&quot;, &quot;AllowedScopes&quot;: [ ] &#125;&#125; ç„¶åè¿˜éœ€è¦åœ¨ApiGatewayé¡¹ç›®ä¸­ä¿®æ”¹appsetting.jsonæ–‡ä»¶ï¼Œæ·»åŠ IdentityServiceæœåŠ¡é…ç½®ã€‚ 1234567&quot;IdentityService&quot;: &#123; &quot;Uri&quot;: &quot;http://localhost:13004&quot;,//è®¤è¯æœåŠ¡IP &quot;DefaultScheme&quot;: &quot;IdentityBearer&quot;, &quot;UseHttps&quot;: false, &quot;ApiName&quot;: &quot;default-api&quot;, &quot;ApiSecret&quot;: &quot;def2edf7-5d42-4edc-a84a-30136c340e13&quot;&#125; æ¥ä¸‹æ¥å°±æ˜¯é…ç½® ApiGatewayé¡¹ç›® Startupæ–‡ä»¶äº†ã€‚ éœ€è¦å¼•å…¥NugetåŒ…ï¼šIdentityServer4.AccessTokenValidation 1234567891011121314151617181920212223242526public void ConfigureServices(IServiceCollection services)&#123; //Identity Server Bearer Tokens Action&lt;IdentityServerAuthenticationOptions&gt; isaOpt = option =&gt; &#123; option.Authority = Configuration[&quot;IdentityService:Uri&quot;]; option.RequireHttpsMetadata = Convert.ToBoolean(Configuration[&quot;IdentityService:UseHttps&quot;]); option.ApiName = Configuration[&quot;IdentityService:ApiName&quot;]; option.ApiSecret = Configuration[&quot;IdentityService:ApiSecret&quot;]; option.SupportedTokens = SupportedTokens.Both; &#125;; services.AddAuthentication().AddIdentityServerAuthentication(Configuration[&quot;IdentityService:DefaultScheme&quot;], isaOpt); services .AddOcelot(Configuration) //å¯ç”¨ç¼“å­˜ .AddCacheManager(x =&gt; &#123; x.WithDictionaryHandle(); &#125;) .AddPolly() services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2); ; services.AddSwaggerGen(options =&gt; &#123; options.SwaggerDoc(Configuration[&quot;Swagger:Name&quot;], new Info &#123; Title = Configuration[&quot;Swagger:Title&quot;], Version = Configuration[&quot;Swagger:Version&quot;] &#125;); &#125;);&#125; é…ç½®å®Œæˆåå¯ç”¨Service.Test1ã€Service.Test2ã€ApiGatewayã€IdentityServiceé¡¹ç›®ã€‚ä½¿ç”¨SwaggerUIè¯·æ±‚ä¼šæç¤º401Unauthorizedï¼Œè¿™ä¸ªæ—¶å€™IdentityServiceå°±èµ·åˆ°ä½œç”¨äº†ã€‚ ä½¿ç”¨PostManå»è¯·æ±‚IdentityServiceè·å–token ä½¿ç”¨tokenè®¿é—®æ¥å£ï¼Œæ•°æ®è¿”å›æ­£å¸¸ è°ƒç”¨Ocelotç®¡ç†APIé€šè¿‡IdentityServer èº«ä»½éªŒè¯æ¥è°ƒç”¨Ocelot ç®¡ç†æ¥å£ã€‚ é¦–å…ˆéœ€è¦åšçš„æ˜¯å¼•å…¥ç›¸å…³çš„NuGetåŒ…ï¼šInstall-Package Ocelot.Administration ä¿®æ”¹ ApiGatewayé¡¹ç›® Startupæ–‡ä»¶ æ·»åŠ ä»£ç .AddAdministration(â€œ/administrationâ€, isaOpt);è·¯å¾„åç§°å¯è‡ªå–ã€‚ 123456789101112131415161718192021222324252627public void ConfigureServices(IServiceCollection services)&#123; //Identity Server Bearer Tokens Action&lt;IdentityServerAuthenticationOptions&gt; isaOpt = option =&gt; &#123; option.Authority = Configuration[&quot;IdentityService:Uri&quot;]; option.RequireHttpsMetadata = Convert.ToBoolean(Configuration[&quot;IdentityService:UseHttps&quot;]); option.ApiName = Configuration[&quot;IdentityService:ApiName&quot;]; option.ApiSecret = Configuration[&quot;IdentityService:ApiSecret&quot;]; option.SupportedTokens = SupportedTokens.Both; &#125;; services.AddAuthentication().AddIdentityServerAuthentication(Configuration[&quot;IdentityService:DefaultScheme&quot;], isaOpt); services .AddOcelot(Configuration) //å¯ç”¨ç¼“å­˜ .AddCacheManager(x =&gt; &#123; x.WithDictionaryHandle(); &#125;) .AddPolly() .AddAdministration(&quot;/administration&quot;, isaOpt); services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2); ; services.AddSwaggerGen(options =&gt; &#123; options.SwaggerDoc(Configuration[&quot;Swagger:Name&quot;], new Info &#123; Title = Configuration[&quot;Swagger:Title&quot;], Version = Configuration[&quot;Swagger:Version&quot;] &#125;); &#125;);&#125; APIæ–¹æ³•POST {adminPath} / connect / token è·å–token è¯·æ±‚çš„ä¸»ä½“æ˜¯è¡¨å•æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤º client_id è®¾ä¸ºç®¡ç†å‘˜ *client_secret *è®¾ç½®ä¸ºè®¾ç½®ç®¡ç†æœåŠ¡æ—¶ä½¿ç”¨çš„ä»»ä½•å†…å®¹ã€‚ scope è®¾ä¸ºç®¡ç†å‘˜ grant_type è®¾ç½®ä¸ºclient_credentials è·å–{adminPath} /configuration è·å¾—å½“å‰çš„Oceloté…ç½®ã€‚ POST {adminPath} / configuration è¿™ä¼šè¦†ç›–ç°æœ‰é…ç½®ã€‚ è¯·æ±‚çš„ä¸»ä½“æ˜¯JSONï¼Œå®ƒä¸æˆ‘ä»¬ç”¨äºåœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šè®¾ç½®Ocelot.jsonæ ¼å¼ç›¸åŒã€‚ å¦‚æœè¦ä½¿ç”¨æ­¤APIï¼Œåˆ™è¿è¡ŒOcelotçš„è¿›ç¨‹å¿…é¡»å…·æœ‰å†™å…¥ocelot.jsonæˆ–ocelot.{environment}.jsonæ‰€åœ¨ç£ç›˜çš„æƒé™ã€‚è¿™æ˜¯å› ä¸ºOcelotä¼šåœ¨ä¿å­˜æ—¶è¦†ç›–å®ƒä»¬ã€‚ åˆ é™¤{adminPath} / outputcache / {region} æ¸…é™¤æ‰€æœ‰ç¼“å­˜åŒºåŸŸ Consulï¼ˆæœåŠ¡å‘ç°ï¼‰å®˜ç½‘åœ°å€ï¼šhttps://www.consul.io/ ConsulåŒ…å«å¤šä¸ªç»„ä»¶,ä½†æ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œæä¾›æœåŠ¡å‘ç°å’ŒæœåŠ¡é…ç½®çš„å·¥å…·ã€‚ ä¸»è¦ç‰¹æ€§ï¼š æœåŠ¡å‘ç°ç»„ä»¶è®°å½•äº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ‰€æœ‰æœåŠ¡çš„ä¿¡æ¯ï¼Œå…¶å®ƒæœåŠ¡å¯ä»¥æ®æ­¤æ‰¾åˆ°è¿™äº›æœåŠ¡ã€‚ å¥åº·æ£€æŸ¥ Consul å®¢æˆ·ç«¯å¯ç”¨æä¾›ä»»æ„æ•°é‡çš„å¥åº·æ£€æŸ¥ã€‚ Key/Valueå­˜å‚¨ åº”ç”¨ç¨‹åºå¯ç”¨æ ¹æ®è‡ªå·±çš„éœ€è¦ä½¿ç”¨ Consul çš„å±‚çº§çš„ Key/Valueå­˜å‚¨ã€‚ å¤šæ•°æ®ä¸­å¿ƒConsulæ”¯æŒå¼€ç®±å³ç”¨çš„å¤šæ•°æ®ä¸­å¿ƒã€‚è¿™æ„å‘³ç€ç”¨æˆ·ä¸éœ€è¦æ‹…å¿ƒéœ€è¦å»ºç«‹é¢å¤–çš„æŠ½è±¡å±‚è®©ä¸šåŠ¡æ‰©å±•åˆ°å¤šä¸ªåŒºåŸŸã€‚ è¿™é‡Œæ¡†æ¶ä¸»è¦ä»‹ç»æœåŠ¡å‘ç°å’Œå¥åº·æ£€æŸ¥ã€‚ æœ¬åœ°éƒ¨ç½²ä¸‹è½½ç›¸åº”ç‰ˆæœ¬consulè½¯ä»¶åŒ…ï¼Œä¸‹è½½åœ°å€ï¼šhttps://www.consul.io/downloads.htmlï¼Œä»¥ä¸‹å†…å®¹ä¸ºwindowsè®²è§£ã€‚æ‰¿æ¥ä¸Šé¢çš„ç½‘å…³é¡¹ç›®ï¼Œæ•´åˆConsulã€‚ å®‰è£… è§£å‹å®Œæˆï¼Œåªæœ‰ä¸€ä¸ªconsul.exeï¼Œåˆ«æ…Œï¼Œç¡®å®å°±åªæœ‰ä¸€ä¸ªæ–‡ä»¶ã€‚ ç®¡ç†å‘˜è¿è¡ŒCMD ï¼ŒCD åˆ°consul æ–‡ä»¶å¤¹ï¼Œç›´æ¥è¿è¡Œ consulå‘½ä»¤ï¼Œå‡ºç°å¦‚ä¸‹é¡µé¢ï¼Œåˆ™é…ç½®æˆåŠŸ æ·»åŠ æœåŠ¡é…ç½®æ·»åŠ æœåŠ¡æ³¨å†Œé…ç½®æ–‡ä»¶ï¼Œåœ¨consul.exeåŒçº§ç›®å½•ä¸‹æ·»åŠ configï¼ˆåå­—å¯è‡ªå–ï¼‰æ–‡ä»¶å¤¹ï¼Œåœ¨configæ–‡ä»¶å¤¹ä¸­åˆ›å»ºservice.jsonï¼ˆåå­—å¯è‡ªå–ï¼‰æ–‡ä»¶ï¼Œç”¨æ¥æ³¨å†ŒæœåŠ¡å’ŒæœåŠ¡æ£€æŸ¥é…ç½®ã€‚å¦‚å›¾æ‰€ç¤ºï¼š é…ç½®service.jsonï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718&#123; &quot;services&quot;: [ &#123; &quot;id&quot;: &quot;API1&quot;,//å”¯ä¸€æ ‡è¯† &quot;name&quot;: &quot;API1&quot;,//æœåŠ¡åç§° &quot;tags&quot;: [ &quot;API1&quot; ],//æœåŠ¡æ ‡ç­¾ &quot;address&quot;: &quot;172.0.0.1&quot;,//æˆ‘éšä¾¿é…çš„IPï¼Œæ³¨æ„é…ç½®æœåŠ¡çš„çœŸå®IPå’Œport &quot;port&quot;: 80 &#125;, &#123; &quot;id&quot;: &quot;API2&quot;, &quot;name&quot;: &quot;API2&quot;, &quot;tags&quot;: [ &quot;API2&quot; ], &quot;address&quot;: &quot;172.0.0.1&quot;,//æˆ‘éšä¾¿é…çš„IP,æ³¨æ„é…ç½®æœåŠ¡çš„çœŸå®IPå’Œport &quot;port&quot;: 81 &#125; ]&#125; è¿™æ ·æœåŠ¡æ³¨å†Œé…ç½®å°±OKäº†ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨é…ç½®å¯åŠ¨Consulï¼Œä¸‹é¢æ˜¯å‡ ç§å½¢å¼å¯åŠ¨consulï¼Œè¯¦ç»†çš„å‘½ä»¤å‚æ•°å¯ä»¥ç§»æ­¥åˆ°å®˜æ–¹æ–‡æ¡£æŸ¥çœ‹ã€‚ ä»¥å¼€å‘æ¨¡å¼å¯åŠ¨ consul agent -dev -config-dir=./config ä»¥æœåŠ¡æ–¹å¼å¯åŠ¨ consul agent -server -bootstrap-expect 2 -data-dir./tmp/consul -node=n1 -bind=192.168.109.241 -ui-dir ./dist -dc=dc1 ä»¥å®¢æˆ·ç«¯æ–¹å¼å¯åŠ¨ consul agent -data-dir ./tmp/consul -ui-dir ./dist-bind=192.168.109.204 -dc=dc1 å¼€å‘æ¨¡å¼å¯åŠ¨å¦‚ä¸‹ï¼Œåœ¨è¾“å‡ºçª—å£ä¸­å¯ä»¥çœ‹åˆ°consul ui HTTP å¯åŠ¨è·¯å¾„ä¸º127.0.0.1:8500 ï¼Œæ³¨å†Œäº†API å’Œ API2 ä¸¤ä¸ªæœåŠ¡ã€‚ æµè§ˆå™¨è®¿é—® 127.0.0.1:8500 ï¼Œå¯ä»¥çœ‹åˆ°Consul UIé¡µé¢ æ·»åŠ æ£€æŸ¥é…ç½®éœ€è¦æŸ¥çœ‹æœåŠ¡çš„è¿è¡ŒçŠ¶æ€æ˜¯å¦å¥åº·ï¼Œå°±éœ€è¦é…ç½®æ£€æŸ¥ã€‚å…·ä½“æ£€æŸ¥é…ç½®ç§»æ­¥å®˜æ–¹æ–‡æ¡£ã€‚ æ£€æŸ¥å®šä¹‰æœ‰ä¸€ä¸‹å‡ ç§ï¼š è„šæœ¬æ£€æŸ¥ï¼š 123456789&#123; &quot;check&quot;: &#123; &quot;id&quot;: &quot;mem-util&quot;, &quot;name&quot;: &quot;Memory utilization&quot;, &quot;args&quot;: [&quot;/usr/local/bin/check_mem.py&quot;, &quot;-limit&quot;, &quot;256MB&quot;], &quot;interval&quot;: &quot;10s&quot;, &quot;timeout&quot;: &quot;1s&quot; &#125;&#125; HTTPæ£€æŸ¥ï¼š 123456789101112&#123; &quot;check&quot;: &#123; &quot;id&quot;: &quot;api&quot;, &quot;name&quot;: &quot;HTTP API on port 5000&quot;, &quot;http&quot;: &quot;https://localhost:5000/health&quot;, &quot;tls_skip_verify&quot;: false, &quot;method&quot;: &quot;POST&quot;, &quot;header&quot;: &#123;&quot;x-foo&quot;:[&quot;bar&quot;, &quot;baz&quot;]&#125;, &quot;interval&quot;: &quot;10s&quot;, &quot;timeout&quot;: &quot;1s&quot; &#125;&#125; TCPæ£€æŸ¥ï¼š 123456789&#123; &quot;check&quot;: &#123; &quot;id&quot;: &quot;ssh&quot;, &quot;name&quot;: &quot;SSH TCP on port 22&quot;, &quot;tcp&quot;: &quot;localhost:22&quot;, &quot;interval&quot;: &quot;10s&quot;, &quot;timeout&quot;: &quot;1s&quot; &#125;&#125; TTLæ£€æŸ¥ï¼š 12345678&#123; &quot;check&quot;: &#123; &quot;id&quot;: &quot;web-app&quot;, &quot;name&quot;: &quot;Web App Status&quot;, &quot;notes&quot;: &quot;Web app does a curl internally every 10 seconds&quot;, &quot;ttl&quot;: &quot;30s&quot; &#125;&#125; Dockeræ£€æŸ¥ï¼š 12345678910&#123; &quot;check&quot;: &#123; &quot;id&quot;: &quot;mem-util&quot;, &quot;name&quot;: &quot;Memory utilization&quot;, &quot;docker_container_id&quot;: &quot;f972c95ebf0e&quot;, &quot;shell&quot;: &quot;/bin/bash&quot;, &quot;args&quot;: [&quot;/usr/local/bin/check_mem.py&quot;], &quot;interval&quot;: &quot;10s&quot; &#125;&#125; gRPCæ£€æŸ¥ï¼š 123456789&#123; &quot;check&quot;: &#123; &quot;id&quot;: &quot;mem-util&quot;, &quot;name&quot;: &quot;Service health status&quot;, &quot;grpc&quot;: &quot;127.0.0.1:12345&quot;, &quot;grpc_use_tls&quot;: true, &quot;interval&quot;: &quot;10s&quot; &#125;&#125; æœ¬åœ°æœåŠ¡çš„åˆ«åæ£€æŸ¥ï¼š 123456&#123; &quot;check&quot;: &#123; &quot;id&quot;: &quot;web-alias&quot;, &quot;alias_service&quot;: &quot;web&quot; &#125;&#125; æˆ‘è¿™è¾¹ç®€å•ä½¿ç”¨äº†TCPæ£€æŸ¥ï¼Œ ç»§ç»­ä¿®æ”¹service.jsonæ–‡ä»¶ï¼Œæ£€æµ‹ tcpä¸ºâ€œ172.0.0.1:80â€çš„æœåŠ¡ï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627&#123; &quot;services&quot;: [ &#123; &quot;id&quot;: &quot;API1&quot;,//å”¯ä¸€æ ‡è¯† &quot;name&quot;: &quot;API1&quot;,//æœåŠ¡åç§° &quot;tags&quot;: [ &quot;API1&quot; ],//æœåŠ¡æ ‡ç­¾ &quot;address&quot;: &quot;172.0.0.1&quot;,//æˆ‘éšä¾¿é…çš„IPï¼Œæ³¨æ„é…ç½®æœåŠ¡çš„çœŸå®IPå’Œport &quot;port&quot;: 80 &#125;, &#123; &quot;id&quot;: &quot;API2&quot;, &quot;name&quot;: &quot;API2&quot;, &quot;tags&quot;: [ &quot;API2&quot; ], &quot;address&quot;: &quot;172.0.0.1&quot;,//æˆ‘éšä¾¿é…çš„IP,æ³¨æ„é…ç½®æœåŠ¡çš„çœŸå®IPå’Œport &quot;port&quot;: 81 &#125; ], &quot;check&quot;: [ &#123; &quot;id&quot;: &quot;APICheck&quot;, &quot;name&quot;: &quot;APICheck&quot;, &quot;tcp&quot;: &quot;119.29.50.115:80&quot;, &quot;interval&quot;: &quot;10s&quot;, &quot;timeout&quot;: &quot;1s&quot; &#125; ]&#125; checkå®šä¹‰ä¸ºserviceåŒçº§èŠ‚ç‚¹åˆ™æ˜¯ä¸ºæ‰€æœ‰æœåŠ¡ä½¿ç”¨åŒä¸€ä¸ªæ£€æŸ¥è§„åˆ™ï¼Œå®šä¹‰åœ¨servicesèŠ‚ç‚¹å†…åˆ™æ˜¯å…·ä½“ä¸ºæŸä¸€ä¸ªæœåŠ¡å®šä¹‰æ£€æŸ¥è§„åˆ™ å¯åŠ¨å¦‚ä¸‹å›¾ï¼Œå¾ˆæ˜æ˜¾å¤šäº†ä¸€ä¸ªåå«APICheck çš„ä»£ç†ã€‚ å¯åŠ¨é¡µé¢ä¹Ÿæœ‰ä¸åŒï¼Œchecks ä¸º2äº†ï¼Œè¯´æ˜checké…ç½®æˆåŠŸäº†ã€‚ç‚¹å‡»æŸä¸ªæœåŠ¡è¿›å»å¯ä»¥æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ dockeréƒ¨ç½²ï¼ˆè…¾è®¯äº‘ï¼‰å‰é¢è¯´çš„æ˜¯æœ¬åœ°éƒ¨ç½²ï¼Œç°åœ¨è¯´ä¸€ä¸‹åŸºäºè…¾è®¯äº‘dockeréƒ¨ç½²ã€‚é¦–å…ˆæ‹‰å»dockeré•œåƒåˆ›å»ºæœåŠ¡ã€‚ Docker Hubï¼ˆé•œåƒæ–‡ä»¶åº“ï¼‰ é‡ŒåŒ…å«Consulçš„é•œåƒæ–‡ä»¶ï¼Œåªéœ€è¦åœ¨Dockeråˆ›å»ºæœåŠ¡ä½¿ç”¨é•œåƒå°±å¯ä»¥äº†ã€‚ è®¾ç½®å®¹å™¨ç«¯å£ä¸º8500ï¼ŒæœåŠ¡ç«¯å£ä¸º80ï¼Œé€šè¿‡Ingressè¿›è¡Œè·¯ç”±è½¬å‘ã€‚ è®¿é—®æœåŠ¡å¤–ç½‘ï¼Œç»“æœå¦‚ä¸‹ï¼Œé…ç½®æˆåŠŸ é…ç½®Ocelot ç½‘å…³é¦–å…ˆä¿®æ”¹å‰é¢çš„ç½‘å…³é¡¹ç›®ApiGateway Startup.cs æ–‡ä»¶é‡Œçš„ ConfigureServicesæ–¹æ³•ï¼Œæ·»åŠ .AddConsul()æ–¹æ³•ä»£ç å¦‚ä¸‹: 12345678910111213141516171819202122232425262728public void ConfigureServices(IServiceCollection services)&#123; //Identity Server Bearer Tokens Action&lt;IdentityServerAuthenticationOptions&gt; isaOpt = option =&gt; &#123; option.Authority = Configuration[&quot;IdentityService:Uri&quot;]; option.RequireHttpsMetadata = Convert.ToBoolean(Configuration[&quot;IdentityService:UseHttps&quot;]); option.ApiName = Configuration[&quot;IdentityService:ApiName&quot;]; option.ApiSecret = Configuration[&quot;IdentityService:ApiSecret&quot;]; option.SupportedTokens = SupportedTokens.Both; &#125;; services.AddAuthentication().AddIdentityServerAuthentication(Configuration[&quot;IdentityService:DefaultScheme&quot;], isaOpt); services .AddOcelot(Configuration) .AddConsul() //å¯ç”¨ç¼“å­˜ .AddCacheManager(x =&gt; &#123; x.WithDictionaryHandle(); &#125;) .AddPolly() .AddAdministration(&quot;/administration&quot;, isaOpt); services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2); ; services.AddSwaggerGen(options =&gt; &#123; options.SwaggerDoc(Configuration[&quot;Swagger:Name&quot;], new Info &#123; Title = Configuration[&quot;Swagger:Title&quot;], Version = Configuration[&quot;Swagger:Version&quot;] &#125;); &#125;);&#125; æ¥ä¸‹æ¥é…ç½®ocelot.json æ–‡ä»¶ï¼Œåœ¨GlobalConfigurationèŠ‚ç‚¹ä¸‹æ·»åŠ æœåŠ¡å‘ç°æä¾›ç¨‹åºé…ç½® 1234567 //æœåŠ¡å‘ç°æä¾›ç¨‹åº&quot;ServiceDiscoveryProvider&quot;: &#123; &quot;Host&quot;: &quot;111.230.118.59&quot;, &quot;Port&quot;: 80, &quot;Type&quot;: &quot;PollConsul&quot;, &quot;PollingInterval&quot;: 1000&#125; é¡¹ç›®ä¸Šæ¸¸é…ç½®æ·»åŠ ServiceName å’Œ UseServiceDiscoveryå±æ€§ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829&#123; &quot;UpstreamPathTemplate&quot;: &quot;/gateway/2/&#123;url&#125;&quot;, &quot;UpstreamHttpMethod&quot;: [ &quot;Get&quot;, &quot;Post&quot;, &quot;Delete&quot;, &quot;Put&quot; ], &quot;DownstreamPathTemplate&quot;: &quot;/api2/&#123;url&#125;&quot;, &quot;DownstreamScheme&quot;: &quot;http&quot;, &quot;ServiceName&quot;: &quot;API2&quot;, &quot;UseServiceDiscovery&quot;: true, &quot;LoadBalancer&quot;: &quot;RoundRobin&quot;, &quot;DownstreamHostAndPorts&quot;: [ &#123; &quot;Host&quot;: &quot;111.230.160.62&quot;, &quot;Port&quot;: 80 &#125;, &#123; &quot;Host&quot;: &quot;localhost&quot;, &quot;Port&quot;: 13002 &#125; ], &quot;QoSOptions&quot;: &#123; &quot;ExceptionsAllowedBeforeBreaking&quot;: 3, &quot;DurationOfBreak&quot;: 10, &quot;TimeoutValue&quot;: 5000 &#125; &quot;AuthenticationOptions&quot;: &#123; &quot;AuthenticationProviderKey&quot;: &quot;IdentityBearer&quot;, &quot;AllowedScopes&quot;: [ ] &#125;&#125; å¯åŠ¨OcelotGatewayï¼ŒAPI001ï¼ŒAPI002é¡¹ç›®ï¼Œé€šè¿‡http://localhost:13000/gateway/1/valuesï¼Œå’Œhttp://localhost:13000/gateway/2/valuesè®¿é—®ï¼›å› ä¸ºOceloté…ç½®äº†Consulçš„æœåŠ¡æ²»ç†ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡é…ç½®çš„æœåŠ¡åç§°å’ŒGlobalConfiguratinçš„Consulhttpapiæ¥å£æŸ¥æ‰¾åˆ°å¯¹åº”æœåŠ¡çš„åœ°å€ï¼Œè¿›è¡Œè®¿é—®ï¼Œè¿™äº›éƒ½æ˜¯Ocelotå¸®æˆ‘ä»¬åšï¼Œè¿™ç‚¹å¾ˆå®¹æ˜“è¯æ˜ï¼Œå¯ä»¥ä¿®æ”¹Consulé…ç½®æ–‡ä»¶ä¸­æœåŠ¡çš„addressä¸ºé”™è¯¯IPï¼Œå°±ä¼šå‘ç°é€šè¿‡13000ç«¯å£è®¿é—®ä¸æˆåŠŸã€‚ é›†æˆæ¶ˆæ¯é˜Ÿåˆ—â€”â€”CAPç®€ä»‹CAP æ˜¯ä¸€ä¸ªåŸºäº .NET Standard çš„ C#åº“ï¼Œå®ƒæ˜¯ä¸€ç§å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡çš„è§£å†³æ–¹æ¡ˆï¼ŒåŒæ ·å…·æœ‰ EventBusçš„åŠŸèƒ½ï¼Œå®ƒå…·æœ‰è½»é‡çº§ã€æ˜“ä½¿ç”¨ã€é«˜æ€§èƒ½ç­‰ç‰¹ç‚¹ã€‚ å¾®æœåŠ¡ç³»ç»Ÿçš„è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨äº‹ä»¶æ¥å¯¹å„ä¸ªæœåŠ¡è¿›è¡Œé›†æˆï¼Œåœ¨è¿™è¿‡ç¨‹ä¸­ç®€å•çš„ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ï¼ŒCAPé‡‡ç”¨çš„æ˜¯å’Œå½“å‰æ•°æ®åº“é›†æˆçš„æœ¬åœ°æ¶ˆæ¯è¡¨çš„æ–¹æ¡ˆæ¥è§£å†³åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿäº’ç›¸è°ƒç”¨çš„å„ä¸ªç¯èŠ‚å¯èƒ½å‡ºç°çš„å¼‚å¸¸ï¼Œå®ƒèƒ½å¤Ÿä¿è¯ä»»ä½•æƒ…å†µä¸‹äº‹ä»¶æ¶ˆæ¯éƒ½æ˜¯ä¸ä¼šä¸¢å¤±çš„ã€‚ Github åœ°å€ï¼šhttps://github.com/dotnetcore/CAP æ”¯æŒæ¶ˆæ¯é˜Ÿåˆ—ï¼š Kafka RabbitMQ AzureServiceBus æ•°æ®åº“å­˜å‚¨ï¼š Sql Server MySql PostgreSQL MongoDB ç¯å¢ƒå‡†å¤‡æˆ‘ä»¬ä»¥RabbitMQ ä¸Sql Serveræ¥è®²è§£ã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…RabbitMQ æœåŠ¡ï¼Œå¾ˆç®€å•ï¼Œå®˜æ–¹ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…ã€‚ ä½†æ˜¯åœ¨å®‰è£…RabbitMQæ—¶ä¼šæç¤ºå®‰è£…Erlangï¼ŒErlangæ˜¯ä¸€ç§é€šç”¨çš„é¢å‘å¹¶å‘çš„ç¼–ç¨‹è¯­è¨€ï¼ŒErlangæ¥ç¼–å†™åˆ†å¸ƒå¼åº”ç”¨è¦ç®€å•çš„å¤šã€‚RabbitMQæ˜¯ç”¨Erlangå®ç°çš„ä¸€ä¸ªé«˜å¹¶å‘é«˜å¯é AMQPæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨ã€‚ å®˜æ–¹ä¸‹è½½å¯¹åº”çš„Erlang å®‰è£…ç¨‹åºï¼Œå»ºè®®RabbitMQå’ŒErlangéƒ½å®‰è£…æœ€æ–°ç‰ˆæœ¬ å®‰è£…å®Œæˆä¹‹åï¼Œä¼šå¤šäº†ä»¥ä¸‹å‡ ä¸ªç¨‹åºï¼Œå®‰è£…åŒ…å¸®æˆ‘ç”Ÿæˆäº†startã€removeã€stopç­‰å‘½ä»¤ç¨‹åºã€‚æˆ‘ä»¬æ‹¿æ¥ç›´æ¥ç”¨å°±å¯ä»¥äº†ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨å‘½ä»¤å¯åŠ¨ã€‚å…ˆè¿è¡Œstartç¨‹åºè¿è¡Œèµ·æ¥ã€‚ .Net Core é›†æˆ CAPNuget åŒ…ä¸‹è½½ï¼š DotNetCore.CAP æ ¸å¿ƒåŒ… DotNetCore.CAP.RabbitMQ CAP RabbitMQ åŒ… DotNetCore.CAP.SqlServer CAP Sql Server æ‰©å±•åŒ… ç»§ç»­ä¿®æ”¹æµ‹è¯•é¡¹ç›®Service.Test1é¡¹ç›®ï¼Œä½¿ç”¨CodeFirstç”Ÿæˆæ•°æ®åº“ï¼š æ–°å»ºæµ‹è¯•ç±»Testï¼š 12345678public class Test&#123; public int Id &#123; get; set; &#125; public string Name &#123; get; set; &#125; public string Title &#123; get; set; &#125;&#125; æ·»åŠ AppDbContext æ•°æ®åº“ä¸Šä¸‹æ–‡ æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234567891011121314public class AppDbContext:DbContext&#123; public AppDbContext(DbContextOptions&lt;AppDbContext&gt; options) : base(options) &#123; &#125; public virtual DbSet&lt;Test&gt; Tests &#123; get; set; &#125; protected override void OnModelCreating(ModelBuilder modelBuilder) &#123; base.OnModelCreating(modelBuilder); &#125;&#125; é…ç½®æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼š 123&quot;ConnectionStrings&quot;: &#123; &quot;Default&quot;: &quot;Server=(localdb)\\\\MSSQLLocalDB; Database=Service_test1; Trusted_Connection=True;&quot;&#125; Program.cs æ–‡ä»¶é…ç½®è¯»å–appsettings.jsonæ–‡ä»¶ã€‚ 12345678public static IWebHostBuilder CreateWebHostBuilder(string[] args) =&gt; WebHost.CreateDefaultBuilder(args) .ConfigureAppConfiguration((hostingContext, config) =&gt; &#123; config.AddJsonFile(&quot;appsettings.json&quot;, optional: true, reloadOnChange: true) .AddEnvironmentVariables(); &#125;) .UseStartup&lt;Startup&gt;(); Startup.cs æ–‡ä»¶ConfigureServicesæ·»åŠ æ•°æ®è®¿é—®é…ç½® 123services.AddDbContext&lt;AppDbContext&gt;(options =&gt; options.UseSqlServer(Configuration.GetConnectionString(&quot;Default&quot;)));services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2); åˆ°è¿™é‡Œæ­£å¸¸çš„CodeFirsté¡¹ç›®é…ç½®å·²ç»å®Œæˆäº†ï¼Œç›´æ¥è¿è¡Œæ•°æ®è¿ç§»å‘½ä»¤å°±å¯ä»¥åˆ›å»ºæ•°æ®åº“äº†ã€‚ ä½†æ˜¯æˆ‘è¿™é‡Œéœ€è¦é›†æˆCAPï¼Œè‚¯å®šè¿™æ ·æ˜¯ä¸è¡Œçš„ã€‚éœ€è¦è¿›è¡ŒCAPçš„é…ç½®ï¼Œç»§ç»­åœ¨ConfigureServicesæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627services.AddDbContext&lt;AppDbContext&gt;(options =&gt; options.UseSqlServer(Configuration.GetConnectionString(&quot;Default&quot;)));services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);Action&lt;CapOptions&gt; capOptions = option =&gt;&#123; option.UseEntityFramework&lt;AppDbContext&gt;(); option.UseSqlServer(Configuration.GetConnectionString(&quot;Default&quot;)); option.UseRabbitMQ(&quot;localhost&quot;);//UseRabbitMQ æœåŠ¡å™¨åœ°å€é…ç½®ï¼Œæ”¯æŒé…ç½®IPåœ°å€å’Œå¯†ç  option.UseDashboard();//CAP2.Xç‰ˆæœ¬ä»¥åå®˜æ–¹æä¾›äº†Dashboardé¡µé¢è®¿é—®ã€‚ if (Convert.ToBoolean(Configuration[&quot;Cap:UseConsul&quot;])) &#123; option.UseDiscovery(discovery =&gt; &#123; discovery.DiscoveryServerHostName = Configuration[&quot;Cap:DiscoveryServerHostName&quot;]; discovery.DiscoveryServerPort = Convert.ToInt32(Configuration[&quot;Cap:DiscoveryServerPort&quot;]); discovery.CurrentNodeHostName = Configuration[&quot;Cap:CurrentNodeHostName&quot;]; discovery.CurrentNodePort = Convert.ToInt32(Configuration[&quot;Cap:CurrentNodePort&quot;]); discovery.NodeId = Convert.ToInt32(Configuration[&quot;Cap:NodeId&quot;]); discovery.NodeName = Configuration[&quot;Cap:NodeName&quot;]; discovery.MatchPath = Configuration[&quot;Cap:MatchPath&quot;]; &#125;); &#125;&#125;;services.AddCap(capOptions); RabbitMQ ä¹Ÿæ˜¯æ”¯æŒé…ç½®options 12345678option.UseRabbitMQ(cfg =&gt;&#123; cfg.HostName = Configuration[&quot;MQ:Host&quot;]; cfg.VirtualHost = Configuration[&quot;MQ:VirtualHost&quot;]; cfg.Port = Convert.ToInt32(Configuration[&quot;MQ:Port&quot;]); cfg.UserName = Configuration[&quot;MQ:UserName&quot;]; cfg.Password = Configuration[&quot;MQ:Password&quot;];&#125;); CAP å†…ç½®é›†æˆäº†ConsulæœåŠ¡æ³¨å†Œï¼Œæ³¨å†Œçš„åŒæ—¶é»˜è®¤æºå¸¦äº†ç®€å†µæ£€æŸ¥ï¼Œä½†æ˜¯åªæ”¯æŒHTTPæ£€æŸ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨æ¥å£ä¸­å®šä¹‰healthè·¯å¾„æä¾›ç»™æ£€æŸ¥è®¿é—®ã€‚ åœ¨appsetting.json æ–‡ä»¶ä¸­æ·»åŠ ç›¸åº”çš„é…ç½®èŠ‚ç‚¹ï¼š 12345678910&quot;Cap&quot;: &#123; &quot;UseConsul&quot;: true,//æ˜¯å¦å¼€å¯ &quot;CurrentNodeHostName&quot;: &quot;localhost&quot;,//å½“å‰èŠ‚ç‚¹IP &quot;CurrentNodePort&quot;: 13001,//å½“å‰èŠ‚ç‚¹Port &quot;DiscoveryServerHostName&quot;: &quot;127.0.0.1&quot;,//å‘ç°æœåŠ¡ä¸»æœºIP &quot;DiscoveryServerPort&quot;: 8500,//å‘ç°æœåŠ¡ä¸»æœºPort &quot;NodeId&quot;: 1,//èŠ‚ç‚¹æ ‡è¯† &quot;NodeName&quot;: &quot;CAP_API1&quot;,//èŠ‚ç‚¹åç§° &quot;MatchPath&quot;: &quot;/api1/TestOnes&quot;//å¥åº·æ£€æŸ¥æ ¹è·¯åŠ² æœ€ç»ˆçš„è·¯å¾„ä¸ºapi1/TestOnes/health&#125; è¿›è¡Œæ•°æ®è¿ç§»åˆ›å»ºæ•°æ®åº“ï¼Œè¡¨ç»“æ„å¦‚ä¸‹ï¼š Cap å‘å¸ƒæ¥ä¸‹æ¥å°±æ˜¯å»ä½¿ç”¨Cap å‘å¸ƒäº†ï¼Œä¿®æ”¹Controllerä»£ç  123456789101112131415161718192021222324public class TestOnesController : ControllerBase&#123; private readonly ICapPublisher _capBus; public TestOnesController(ICapPublisher capPublisher) &#123; _capBus = capPublisher; &#125; [HttpGet] public ActionResult&lt;IEnumerable&lt;string&gt;&gt; Get() &#123; _capBus.Publish(&quot;services.test1.show.time&quot;, DateTime.Now); return new string[] &#123; &quot;TestOnes_value1&quot;, &quot;TestOnes_value2&quot; &#125;; &#125; //å®šä¹‰è·¯ç”±ä¸ºhealthæä¾›ç»™æœåŠ¡æ£€æŸ¥ä½¿ç”¨ [HttpGet] [Route(&quot;health&quot;)] public ActionResult&lt;string&gt; Health() &#123; return &quot;Health!!!!!&quot;; &#125;&#125; å› ä¸ºå¯ç”¨çš„Consul ï¼Œæ‰€ä»¥è¦æŒ‰ç…§å‰é¢è¯´è¿‡çš„consul æ•™ç¨‹æ¥å¯åŠ¨consul è®¿é—®http://127.0.0.1:8500ï¼Œé¡µé¢å¦‚ä¸‹ æ¥ä¸‹æ¥å¯åŠ¨é¡¹ç›®ï¼Œè¿˜æ˜¯è€æ ·å­ç›´æ¥çœ‹åˆ°å¦‚ä¸‹é¡µé¢ã€‚ ä½†æ˜¯æˆ‘ä»¬é›†æˆäº†CAPï¼Œæ‰€ä»¥å¯ä»¥è®¿é—®å‘¢http://localhost:13001/cap è®¿é—®capDashboardé¡µé¢æŸ¥çœ‹è¯¦ç»† è¿™é‡Œä¸€èˆ¬å¯åŠ¨çš„è¯å‘å‡ºçš„æ—¶ä¸å­˜åœ¨ï¼Œä¹Ÿæ˜¯å› ä¸ºå‰é¢æœ‰æµ‹è¯•è¿‡ï¼Œæ•°æ®åº“é‡Œå­˜åœ¨äº†ã€‚æˆ‘ä»¬è°ƒç”¨api1/TestOnesæ–¹æ³•å‘å‡ºæ¶ˆæ¯ã€‚ è¯·æ±‚æˆåŠŸï¼Œåœ¨æ¥çœ‹çœ‹æ•°æ®åº“ã€‚æ•°æ®åº“å¤šäº†ä¸¤å¼ è¡¨ï¼Œä»¥å¼ æ˜¯æ¥æ”¶æ•°æ®è¡¨ï¼Œä¸€å¼ æ˜¯å‘å¸ƒæ•°æ®è¡¨ã€‚ å†æ¥çœ‹çœ‹é‡Œé¢çš„æ•°æ®ï¼Œä¹Ÿæ˜¯å°±æ˜¯å‘å¸ƒçš„æ¶ˆæ¯ï¼Œå› ä¸ºä¹‹å‰è¯·æ±‚è¿‡å››æ¬¡ï¼Œæˆ‘è¿™è¾¹å°±å¤šäº†å››æ¡æ•°æ®ã€‚ cap Dashboardä¹Ÿèƒ½çœ‹åˆ°ä¸€äº›ç»Ÿè®¡å’Œæ•°æ®åˆ—è¡¨ å†æ¥çœ‹çœ‹consul é¡µé¢ï¼Œä¸€ä¸ªCAP_API1 çš„æœåŠ¡å·²ç»è¢«æ³¨å†Œè¿›æ¥äº† å¦‚æœå‰é¢ MatchPathè·¯å¾„æ²¡æœ‰é…ç½®å¯¹çš„è¯ï¼Œå°±ä¼šå‡ºç°ä¸‹é¢çš„æƒ…å†µï¼Œå¯¼è‡´æ— æ³•é€šè¿‡å¥åº·æ£€æŸ¥ã€‚ Cap è®¢é˜…ï¼ˆæ¥æ”¶ï¼‰ä½¿ç”¨APIè®¢é˜…æ¶ˆæ¯ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œä½¿ç”¨åŒä¸€ä¸ªé¡¹ç›®çš„å¦ä¸€ä¸ªæ¥å£å®ç°è®¢é˜… 123456789101112[Route(&quot;api1/[controller]&quot;)][ApiController]public class ValuesController : ControllerBase&#123; [HttpGet(&quot;Received&quot;)] [CapSubscribe(&quot;services.test1.show.time&quot;)]//é…ç½®å‘å¸ƒæ—¶å¡«å†™çš„Name public ActionResult&lt;string&gt; GetReceivedMessage(DateTime datetime) &#123; Console.WriteLine(&quot;è®¢é˜…:&quot;+datetime); return &quot;è®¢é˜…:&quot; + datetime; &#125;&#125; è¿™æ ·å°±OKäº†ï¼Œä½†æ˜¯å¦‚æœä½ æ—¶åœ¨ä¸åŒçš„é¡¹ç›®ï¼Œè¿˜æ˜¯éœ€è¦åƒå‰é¢ä¸€æ ·é…ç½®CAPã€‚ å¯åŠ¨é¡¹ç›®è¯·æ±‚ä¸€æ¬¡CAPå‘å¸ƒæ¥å£ï¼ŒæŸ¥çœ‹http://localhost:13001/capå¯ä»¥çœ‹åˆ°æ¥æ”¶çš„é‡Œé¢æœ‰1æ¡æ•°æ® è®¢é˜…åˆ—è¡¨ä¸­ä¹Ÿæœ‰äº†ä¸€æ¡æ•°æ® åœ¨æ¥çœ‹æ•°æ®åº“ä¹Ÿæ·»åŠ ä¸€æ¡æ•°æ® æœ€åâ€”â€”é™„ä¸Šæ€»ä½“ä»£ç æ•´ä¸ªå®è·µä»£ç å·²æ‰˜ç®¡åˆ°Githubï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼šhttps://github.com/magicodes/Magicodes.Simple.Services","categories":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/categories/NET-CORE/"},{"name":"å¾®æœåŠ¡","slug":"NET-CORE/å¾®æœåŠ¡","permalink":"https://zcheng.site/categories/NET-CORE/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"},{"name":"æ¶æ„","slug":"NET-CORE/å¾®æœåŠ¡/æ¶æ„","permalink":"https://zcheng.site/categories/NET-CORE/%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E6%9E%B6%E6%9E%84/"}],"tags":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/tags/NET-CORE/"},{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"https://zcheng.site/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"},{"name":"Ocelot","slug":"Ocelot","permalink":"https://zcheng.site/tags/Ocelot/"},{"name":"Consul","slug":"Consul","permalink":"https://zcheng.site/tags/Consul/"}]},{"title":"ODataâ€”â€”è®©æŸ¥è¯¢å˜çš„éšå¿ƒæ‰€æ¬²","slug":"ODataâ€”â€”è®©æŸ¥è¯¢å˜çš„éšå¿ƒæ‰€æ¬²","date":"2020-05-08T00:49:31.000Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"ODataâ€”â€”è®©æŸ¥è¯¢å˜çš„éšå¿ƒæ‰€æ¬².html","link":"","permalink":"https://zcheng.site/OData%E2%80%94%E2%80%94%E8%AE%A9%E6%9F%A5%E8%AF%A2%E5%8F%98%E7%9A%84%E9%9A%8F%E5%BF%83%E6%89%80%E6%AC%B2.html","excerpt":"","text":"ODataæ˜¯ä»€ä¹ˆOpen Data Protocolï¼ˆå¼€æ”¾æ•°æ®åè®®ï¼ŒODataï¼‰æ˜¯ç”¨æ¥æŸ¥è¯¢å’Œæ›´æ–°æ•°æ®çš„ä¸€ç§Webåè®®ï¼Œå…¶æä¾›äº†æŠŠå­˜åœ¨äºåº”ç”¨ç¨‹åºä¸­çš„æ•°æ®æš´éœ²å‡ºæ¥çš„æ–¹å¼ã€‚ODataè¿ç”¨ä¸”æ„å»ºäºå¾ˆå¤šWebæŠ€æœ¯ä¹‹ä¸Šï¼Œæ¯”å¦‚HTTPã€Atom Publishing Protocolï¼ˆAtomPubï¼‰å’ŒJSONï¼Œæä¾›äº†ä»å„ç§åº”ç”¨ç¨‹åºã€æœåŠ¡å’Œå­˜å‚¨åº“ä¸­è®¿é—®ä¿¡æ¯çš„èƒ½åŠ›ã€‚ODataè¢«ç”¨æ¥ä»å„ç§æ•°æ®æºä¸­æš´éœ²å’Œè®¿é—®ä¿¡æ¯ï¼Œè¿™äº›æ•°æ®æºåŒ…æ‹¬ä½†ä¸é™äºï¼šå…³ç³»æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿã€å†…å®¹ç®¡ç†ç³»ç»Ÿå’Œä¼ ç»ŸWebç«™ç‚¹ã€‚æ›´å¤šè¯¦ç»†å®šä¹‰å¯ä»¥æŸ¥é˜…ODataå®˜ç½‘ï¼Œæ¥ä¸‹æ¥ç”¨ç¤ºä¾‹çœ‹çœ‹ODataæ˜¯æ€ä¹ˆè®©æŸ¥è¯¢éšå¿ƒæ‰€æ¬²ã€‚ ç¤ºä¾‹æ–°å»ºä¸€ä¸ª.NET CORE 3+ WEBAPI é¡¹ç›®ï¼Œå®‰è£… Microsoft.AspNetCore.OData åŠå…¶æ‰€æœ‰ä¾èµ–é¡¹æ·»åŠ æµ‹è¯•æ¨¡å‹Studentï¼Œç”¨æ¥è¿›è¡Œæ•°æ®æŸ¥è¯¢ 123456public class Student&#123; public int Id &#123; get; set; &#125; public string Name &#123; get; set; &#125; public int Age &#123; get; set; &#125;&#125; æ·»åŠ æ•°æ®è°ƒç”¨æ§åˆ¶å™¨ï¼Œç»§æ‰¿ ControllerBase ï¼Œæ·»åŠ Get æ–¹æ³•ä»¥ä¾¿äºæ’å™Student æ•°æ®ï¼Œæ·»åŠ  [EnableQuery] ï¼Œç”¨æ¥æ”¯æŒODataæŸ¥è¯¢é€‰é¡¹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738[Route(&quot;api/[controller]&quot;)]public class TestController : ControllerBase&#123; private List&lt;Student&gt; students = new List&lt;Student&gt;() &#123; new Student() &#123; Id = 1, Name = &quot;å¼ ä¸‰&quot;, Age = 18, &#125;, new Student() &#123; Id = 2, Name = &quot;æå››&quot;, Age = 88, &#125;, new Student() &#123; Id = 3, Name = &quot;èµµäº”&quot;, Age = 20, &#125;, new Student() &#123; Id = 4, Name = &quot;ç‹å…­&quot;, Age = 42, &#125; &#125;; [EnableQuery] [HttpGet] public List&lt;Student&gt; Get() &#123; return students; &#125;&#125; æ¥ä¸‹æ¥åœ¨Startup é…ç½®OData 1234567public void ConfigureServices(IServiceCollection services)&#123; services.AddControllers(); //æ·»åŠ OData services.AddOData();&#125; 12345678910111213141516171819202122public void Configure(IApplicationBuilder app, IWebHostEnvironment env)&#123; if (env.IsDevelopment()) &#123; app.UseDeveloperExceptionPage(); &#125; app.UseHttpsRedirection(); app.UseRouting(); app.UseAuthorization(); //é…ç½®OData è·¯ç”±èŠ‚ç‚¹ app.UseEndpoints(endpoints =&gt; &#123; endpoints.MapControllers(); endpoints.EnableDependencyInjection(); endpoints.Filter().Count().Expand().OrderBy().Select().MaxTop(null).; &#125;);&#125; è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥é˜…äº†å¾ˆå¤šæ–‡æ¡£èµ„æ–™ï¼Œéƒ½æ˜¯ç”¨çš„ä»¥ä¸‹é…ç½®ï¼Œå…ˆç¦ç”¨æ‰äº†æ§åˆ¶å™¨çš„ç«¯ç‚¹è·¯ç”±é…ç½®ï¼Œç„¶ååœ¨Configureä¸­ä½¿ç”¨MVCè·¯ç”±é…ç½®ï¼Œè¿™æ ·ä¹Ÿæ˜¯å¯ä»¥äº†ï¼Œä½†æ˜¯OData7.4ç‰ˆæœ¬å·²ç»æ”¯æŒç«¯ç‚¹è·¯ç”±é…ç½®äº†ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦é‚£æ ·å»åšäº† 1234567891011121314151617181920212223242526272829//ä¸æ¨èå†™æ³•public void ConfigureServices(IServiceCollection services)&#123; services.AddControllers(mvcOptions=&gt;mvcOption.EnableEndpointRouting = false); //æ·»åŠ OData services.AddOData();&#125;public void Configure(IApplicationBuilder app, IWebHostEnvironment env)&#123; if (env.IsDevelopment()) &#123; app.UseDeveloperExceptionPage(); &#125; app.UseHttpsRedirection(); app.UseRouting(); app.UseAuthorization(); app.UseMvc(routeBuilder =&gt; &#123; routeBuilder.EnableDependencyInjection(); routeBuilder.Filter().Count().Expand().OrderBy().Select().MaxTop(null).; &#125;); &#125; ç°åœ¨å¯ä»¥åœ¨æ•°æ®ä¸Šå°è¯•$selectï¼Œ$orderbyï¼Œ$filterï¼Œ$countï¼Œ$skip å’Œ$topçš„å¸¸è§„æ“ä½œï¼Œç»“æœå¦‚å›¾æ‰€ç¤ºï¼š é»˜è®¤æƒ…å†µä¸‹ /api/test $ orderby /api/test?$orderby=age desc $ orderby /api/test?$filter=age eq 42filter è¯­æ³•æ¡ä»¶åˆ—è¡¨|æ¡ä»¶ | å¤‡æ³¨ | ç¤ºä¾‹ ||â€“|â€“|â€“|eq |ç­‰äº |$filter=priority et 1ne| ä¸ç­‰äº |$filter=priority ne 1gt| å¤§äº| $filter=priority gt 1ge| å¤§äºæˆ–ç­‰äº| $filter=priority ge 1lt |å°‘äº |$filter=priority lt 1le| å°äºæˆ–ç­‰äº |$filter=priority le 1and| å¹¶ä¸” |$filter=priority gt 1 and priority lt 10or| æˆ–è€…| $filter=priority gt 1 or priority lt 10not| ä¸æ˜¯ |$filter=not endswith(name,â€™taskâ€™) $ skip&amp; $ top /api/test? $skip=2&amp; $top=2ä½†æ˜¯åœ¨æ‰§è¡Œ select çš„æ—¶å€™æ•°æ®å‡ºç°äº†é—®é¢˜ è¿™æ˜¯å› ä¸ºé‡‡ç”¨éEdmè·¯çº¿é…ç½®ODataï¼Œåˆ™éœ€è¦å®‰è£…Microsoft.AspNetCore.Mvc.NewtonsoftJson è½¯ä»¶åŒ…æ¥è§£å†³Jsonæ ¼å¼é—®é¢˜ ï¼Œç„¶åä¿®æ”¹Startupæ–‡ä»¶ConfigureService ä»¥å¯ç”¨Jsonæ ¼å¼æ‰©å±•æ–¹æ³• 1234567public void ConfigureServices(IServiceCollection services)&#123; services.AddControllers().AddNewtonsoftJson(); services.AddOData();&#125; é…ç½®å®Œæˆä¹‹åæˆ‘ä»¬åœ¨æ¥çœ‹çœ‹select ç»“æœï¼Œå¾ˆæ˜¾ç„¶æ•°æ®æœ‰äº†å˜åŠ¨ï¼ŒåªæŸ¥å‡ºäº†nameå­—æ®µ è¿™é‡Œé¡ºä¾¿åœ¨æä¸€ä¸‹Edmè·¯çº¿é…ç½®ODataï¼Œä¸»è¦åŒºåˆ«åœ¨ä¸ODataè·¯ç”±ç­–ç•¥çš„é…ç½® 12345678910111213141516171819202122232425262728public void Configure(IApplicationBuilder app, IWebHostEnvironment env)&#123; if (env.IsDevelopment()) &#123; app.UseDeveloperExceptionPage(); &#125; app.UseHttpsRedirection(); app.UseRouting(); app.UseAuthorization(); app.UseEndpoints(endpoints =&gt; &#123; endpoints.MapControllers(); endpoints.Select().Filter().OrderBy().Count().MaxTop(null); endpoints.MapODataRoute(&quot;odata&quot;, &quot;odata&quot;, GetEdmModel()); &#125;);&#125;private IEdmModel GetEdmModel()&#123; var odataBuilder = new ODataConventionModelBuilder(); odataBuilder.EntitySet&lt;Student&gt;(&quot;Student&quot;); return odataBuilder.GetEdmModel();&#125; æ€»ç»“ç°åœ¨OData åœ¨.NET CORE 3.1çš„é…ç½®å·²ç»åˆæ­¥é…ç½®å®Œï¼Œæ˜¯ä¸æ˜¯è§‰å¾—æ•°æ®æŸ¥è¯¢å˜çš„éšå¿ƒæ‰€æ¬²ï¼Œåœ¨ä¹Ÿä¸éœ€è¦ä¸ºäº†éœ€æ±‚çš„å˜åŠ¨æ¥å›ä¿®æ”¹Dtoäº†ï¼ŒOData çš„è¯­æ³•è¿œè¿œä¸æ­¢è¿™äº›ï¼Œå¦‚éœ€äº†è§£è¯·ç§»æ­¥åˆ°å®˜ç½‘æŸ¥çœ‹æ›´å¤šè¯­æ³•","categories":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/categories/NET-CORE/"}],"tags":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/tags/NET-CORE/"},{"name":"OData","slug":"OData","permalink":"https://zcheng.site/tags/OData/"}]},{"title":"Autofacåœ¨.NET Core ä¸­çš„ä½¿ç”¨","slug":"Autofacåœ¨.NET_Core_ä¸­çš„ä½¿ç”¨","date":"2020-05-06T23:40:37.000Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"Autofacåœ¨.NET_Core_ä¸­çš„ä½¿ç”¨.html","link":"","permalink":"https://zcheng.site/Autofac%E5%9C%A8.NET_Core_%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8.html","excerpt":"","text":"å‰è¨€Autofac æ˜¯ä¸€æ¬¾.NET IoC å®¹å™¨ . å®ƒç®¡ç†ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³», ä»è€Œä½¿åº”ç”¨åœ¨è§„æ¨¡åŠå¤æ‚æ€§å¢é•¿çš„æƒ…å†µä¸‹ä¾ç„¶å¯ä»¥è½»æ˜“åœ°ä¿®æ”¹ ã€‚.NET CORE ä¸­ä¹Ÿå†…ç½®äº†ä¾èµ–æ³¨å…¥ï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µä¸‹éœ€è¦ç”¨åˆ°Autofacå»è¿›è¡Œä¾èµ–æ³¨å…¥ï¼ŒAutofacæ”¯æŒçš„æ‰€æœ‰æ³¨å…¥æ–¹å¼ä»¥å¤–ï¼Œè¿˜æ”¯æŒå±æ€§æ³¨å…¥å’Œæ–¹æ³•æ³¨å…¥ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ç¤ºä¾‹æ¥ç®€å•äº†è§£Autofacçš„ä½¿ç”¨ ç¤ºä¾‹æ–°å»ºä¸¤ä¸ª.NET CORE é¡¹ç›®ï¼Œä¸€ä¸ªWEBå±‚ï¼Œä¸€ä¸ªæœåŠ¡å±‚ æœåŠ¡å±‚ä¸­æ·»åŠ å‡ ä¸ªæµ‹è¯•æœåŠ¡å’Œæ¨¡å—æ–‡ä»¶ æœåŠ¡ä»£ç éƒ½å¦‚å›¾æ‰€ç¤º å¼•å…¥Autofac NugetåŒ…æ–‡ä»¶ NetCoreAutofacServiceModule ç±»ç»§æ‰¿Autofac.Moduleï¼Œå¹¶é‡å†™Autofacç®¡é“ä¸­çš„Loadæ–¹æ³•ï¼Œå¦‚ä¸‹å›¾å¤šç§æ–¹å¼æ³¨å…¥æœåŠ¡ã€‚ æ¥ä¸‹æ¥å°±æ˜¯åœ¨WEBå±‚é…ç½®Autofacï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯.Net Core2+ å’Œ .Net Core3+ çš„é…ç½®æ–¹æ³•ç¨æœ‰ä¸åŒ .NET CORE 2+ åœ¨NET Core 2.1æ—¶å€™ï¼ŒAutoFacè¿”å›ä¸€ä¸ª IServiceProvider å‚æ•°æ³¨å…¥åˆ°ConfigureServices .NET Core æœåŠ¡ä¸­ï¼Œå†™æ³•å¦‚ä¸‹ï¼š 12345public IServiceProvider ConfigureServices(IServiceCollection services)&#123; services.AddControllers(); return AutofacProvider.RegisterForNetCore2(services);&#125; 123456789//å°†å®šä¹‰çš„ç­–ç•¥å’ŒAutoFac ä¸€èµ·æ›¿æ¢å†…ç½®DIpublic static IServiceProvider RegisterForNetCore2(IServiceCollection services) &#123; var builder = new ContainerBuilder(); builder.Populate(services); //æŒ‰æ¨¡å—æ³¨å…¥æœåŠ¡ builder.RegisterModule&lt;NetCoreAutofacServiceModule&gt;(); var Container = builder.Build(); return new AutofacServiceProvider(Container);&#125; .NET CORE 3+ åœ¨.NET Core3.0 ä½¿ç”¨ä¸Šé¢çš„å†™æ³•ï¼Œæ¡†æ¶è¿è¡Œä¹‹åä¼šæŠ¥é”™ï¼š ConfigureServices returning an System.IServiceProvider isnâ€™t supported. .NET Core 3.0 å¼•å…¥äº†å…·æœ‰å¼ºç±»å‹å®¹å™¨é…ç½®çš„åŠŸèƒ½ã€‚å®ƒæä¾›äº† ConfigureContainer æ–¹æ³•ï¼Œå¯ä»¥åœ¨å…¶ä¸­ä½¿ç”¨Autofacæ¥æ³¨å†Œäº‹ç‰©ï¼Œè€Œä¸å¿…é€šè¿‡ ServiceCollection æ¥æ³¨å†Œäº‹ç‰©ã€‚é¦–å…ˆéœ€è¦åœ¨ Program.cs ä¸­ä¿®æ”¹æœåŠ¡å·¥å‚ï¼Œå†…ç½®æ˜¯ ServiceProviderFactory çš„ï¼Œä¿®æ”¹æŒ‡å®šä¸ºï¼š AutofacServiceProviderFactory ã€‚ 1234567public static IHostBuilder CreateHostBuilder(string[] args) =&gt; Host.CreateDefaultBuilder(args) .ConfigureWebHostDefaults(webBuilder =&gt; &#123; webBuilder.UseStartup&lt;Startup&gt;(); &#125;) .UseServiceProviderFactory(new AutofacServiceProviderFactory()); ç„¶ååœ¨ Startup.cs ä¸­æ·»åŠ æ–¹æ³• ConfigureContainer ï¼Œå¹¶é…ç½®Autofacç­–ç•¥ 1234public void ConfigureContainer(ContainerBuilder builder)&#123; AutofacProvider.RegisterForNetCore3(builder);&#125; 1234public static void RegisterForNetCore3(ContainerBuilder builder)&#123; builder.RegisterModule&lt;NetCoreAutofacServiceModule&gt;();&#125; æœ€ååœ¨æ§åˆ¶å™¨ä¸­ä¾èµ–æ³¨å…¥æœåŠ¡ï¼Œå¯ä»¥åœ¨æ–¹æ³•ä¸Šç”¨[FromServices]æ³¨å…¥ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ 12345678[HttpGet][Route(&quot;GetName&quot;)]public string GetName([FromServices] IThreeRepository threeRepository, [FromServices] IOneService oneService, [FromServices] ITwoService twoService)&#123; return $&quot;ã€threeRepositoryã€‘ : &#123;threeRepository.GetName()&#125;; ã€oneServiceã€‘ : &#123;oneService.GetName()&#125; ; ã€twoServiceã€‘ : &#123;twoService.GetName()&#125;&quot;;&#125; å¯åŠ¨æœåŠ¡çœ‹çœ‹ç»“æœæœåŠ¡å·²ç»æ³¨å†ŒæˆåŠŸThreeRepository ä¸ IThreeRepository é€šè¿‡ RegisterType æ–¹æ³•æ³¨å†Œï¼› 1builder.RegisterType&lt;ThreeRepository&gt;().AsImplementedInterfaces(); OneServiceã€IOneServiceã€TwoServiceã€ITwoService åˆ™æ˜¯é€šè¿‡RegisterAssemblyTypesæ–¹å¼æ³¨å†Œï¼› 1builder.RegisterAssemblyTypes(typeof(NetCoreAutofacServiceModule).Assembly).Where(a =&gt; a.Name.EndsWith(&quot;Service&quot;)).AsImplementedInterfaces();","categories":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/categories/NET-CORE/"}],"tags":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/tags/NET-CORE/"},{"name":"Autofac","slug":"Autofac","permalink":"https://zcheng.site/tags/Autofac/"}]},{"title":"è¯¦è§£.NET Core ä¾èµ–æ³¨å…¥ç”Ÿå‘½å‘¨æœŸ","slug":"è¯¦è§£.NET_Core_ä¾èµ–æ³¨å…¥ç”Ÿå‘½å‘¨æœŸ","date":"2020-05-04T21:24:41.000Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"è¯¦è§£.NET_Core_ä¾èµ–æ³¨å…¥ç”Ÿå‘½å‘¨æœŸ.html","link":"","permalink":"https://zcheng.site/%E8%AF%A6%E8%A7%A3.NET_Core_%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.html","excerpt":"","text":"å‰è¨€.NET Core è‡ªå¸¦ä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œæ”¯æŒä¸‰ç§ä¸åŒç”Ÿå‘½å‘¨æœŸçš„æ³¨å…¥æ¨¡å¼ï¼š Singleton å•ä¾‹æ¨¡å¼ Scoped åŒºåŸŸæ¨¡å¼ Transient ç¬æ—¶æ¨¡å¼ ä½†æ˜¯å¸¸å¸¸ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å“ªç§æ¨¡å¼æ‰æœ€åˆé€‚ï¼Œæ¥ä¸‹æ¥æˆ‘å°±ç”¨ä»£ç è¯¦ç»†è§£è¯»ä¸€ä¸‹ä¸‰ç§æ¨¡å¼ ä»£ç ç¤ºä¾‹é¦–å…ˆæ–°å»º.NET Core APIé¡¹ç›®æ¥è¿›è¡Œä»£ç æµ‹è¯• åˆ†åˆ«æ–°å»º Scopedã€Singletonã€Transient ä¸‰ç§æ¨¡å¼çš„æœåŠ¡ä¸æ¥å£ï¼Œé‡Œé¢å†™ä¸€ä¸ªGetIndex() æ–¹æ³•è·å–index ï¼Œç”¨æ¥åŒºåˆ«æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸã€‚ä¸‰ä¸ªæœåŠ¡ä»£ç éƒ½æ˜¯å¦‚æ­¤ï¼Œç„¶åæ·»åŠ ä¾èµ–æ³¨å…¥æœ€ååœ¨æ§åˆ¶å™¨ä¸­å¤©åŠ æµ‹è¯•æ–¹æ³• ä½¿ç”¨ [FromService] ç‰¹æ€§æ³¨å…¥æœåŠ¡ï¼Œæ¯æ¬¡æœåŠ¡æ³¨å…¥ä¸¤æ¬¡ï¼Œç”¨æ¥åŒºåˆ«æœåŠ¡çš„å˜åŒ–ï¼Œè¾“å‡ºæœåŠ¡çš„indexï¼Œå¯åŠ¨é¡¹ç›®æŸ¥çœ‹ç»“æœ ä¸Šå›¾å¯ä»¥çœ‹åˆ°å•ä¾‹å’ŒåŒºåŸŸæ¨¡å¼ä¸‹ï¼Œä¸¤æ¬¡æ³¨å…¥çš„æœåŠ¡indexæ˜¯å åŠ çš„ï¼Œå¯ä»¥è¯´æ˜ä¸¤æ¬¡æœåŠ¡æ³¨å…¥çš„éƒ½æ˜¯åŒä¸€ä¸ªã€‚è€Œç¬æ—¶æ¨¡å¼ä¸¤æ¬¡æ³¨å…¥çš„æœåŠ¡indexéƒ½æ˜¯åˆå§‹å€¼ï¼Œä¹Ÿå°±è¯´æ˜ä¸¤æ¬¡æœåŠ¡éƒ½æ˜¯æ–°çš„ã€‚ç„¶åæˆ‘ä»¬ä¸åœæ­¢é¡¹ç›®åœ¨æ‰§è¡Œä¸€æ¬¡æ–¹æ³•å¯ä»¥çœ‹åˆ°å•åˆ—æ¨¡å¼å’ŒåŒºåŸŸæ¨¡å¼æœ‰äº†ä¸åŒï¼Œå•ä¾‹æ¨¡å¼æ³¨å…¥çš„æœåŠ¡ï¼Œindexå€¼ä¸€ç›´åœ¨å åŠ ï¼Œè€ŒåŒºåŸŸæ¨¡å¼æœ‰é‡æ–°ä»0å¼€å§‹å åŠ ã€‚ æ€»ç»“ç»“åˆä»¥ä¸Šç¤ºä¾‹å¯ä»¥æ¸…æ¥šçš„åˆ†åˆ«ä¸‰ç§æ¨¡å¼çš„å·®åˆ« Singletonå•ä¾‹æ¨¡å¼ï¼ŒæœåŠ¡åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶è¢«åˆ›å»ºï¼Œå…¶åçš„æ¯æ¬¡è¯·æ±‚éƒ½æ²¿ç”¨è¿™ä¸ªå·²åˆ›å»ºçš„æœåŠ¡ã€‚ Scopedä½œç”¨åŸŸæ¨¡å¼ï¼ŒæœåŠ¡åœ¨æ¯æ¬¡è¯·æ±‚æ—¶è¢«åˆ›å»ºï¼Œæ•´ä¸ªè¯·æ±‚è¿‡ç¨‹ä¸­éƒ½è´¯ç©¿ä½¿ç”¨è¿™ä¸ªåˆ›å»ºçš„æœåŠ¡ã€‚ Transient ç¬æ€æ¨¡å¼ï¼ŒæœåŠ¡åœ¨æ¯æ¬¡è¯·æ±‚æ—¶è¢«åˆ›å»º","categories":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/categories/NET-CORE/"}],"tags":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/tags/NET-CORE/"},{"name":"ä¾èµ–æ³¨å…¥","slug":"ä¾èµ–æ³¨å…¥","permalink":"https://zcheng.site/tags/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/"}]},{"title":"ABPæ¡†æ¶ä½¿ç”¨æ‹¦æˆªå™¨åŠ¨æ€é…ç½®ç§Ÿæˆ·è¿‡æ»¤å™¨","slug":"ABPæ¡†æ¶ä½¿ç”¨æ‹¦æˆªå™¨åŠ¨æ€é…ç½®ç§Ÿæˆ·è¿‡æ»¤å™¨","date":"2020-04-25T00:31:20.000Z","updated":"2021-01-25T05:45:48.547Z","comments":true,"path":"ABPæ¡†æ¶ä½¿ç”¨æ‹¦æˆªå™¨åŠ¨æ€é…ç½®ç§Ÿæˆ·è¿‡æ»¤å™¨.html","link":"","permalink":"https://zcheng.site/ABP%E6%A1%86%E6%9E%B6%E4%BD%BF%E7%94%A8%E6%8B%A6%E6%88%AA%E5%99%A8%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE%E7%A7%9F%E6%88%B7%E8%BF%87%E6%BB%A4%E5%99%A8.html","excerpt":"","text":"å‰è¨€æœ€è¿‘é¡¹ç›®è¦æ±‚åœ¨ABPæ¡†æ¶ä¸­æ ¹æ®TenantIdæ˜¯å¦ä¸ºç©ºæ¥é…ç½®æ˜¯å¦ç¦ç”¨ç§Ÿæˆ·è¿‡æ»¤å™¨ã€‚ABPè‡ªèº«ç»™æˆ‘æˆ‘ä»¬ç¦ç”¨ç§Ÿæˆ·è¿‡æ»¤å™¨çš„ä¸¤ç§æ–¹æ³•å®˜æ–¹æ–‡æ¡£ æ–¹æ³•ä¸€ï¼šä½¿ç”¨å·¥ä½œå•å…ƒ1234using (_unitOfWorkManager.Current.DisableFilter(AbpDataFilters.MayHaveTenant))&#123; var people2 = _personRepository.GetAllList(); &#125; æ–¹æ³•äºŒï¼šå…¨å±€ç¦ç”¨è¿‡æ»¤å™¨ 1Configuration.UnitOfWork.OverrideFilter(AbpDataFilters.MayHaveTenant, false); ä½†æ˜¯æ–¹æ³•ä¸€è¦ä¿®æ”¹çš„åœ°æ–¹å¾ˆå¤šï¼Œå«Œéº»çƒ¦ï¼›æ–¹æ³•äºŒåªèƒ½å…¨å±€åœ¨Configurationä¸­é…ç½®ï¼Œä¸èƒ½åŠ¨æ€æ”¹å˜ï¼Œä¹Ÿä¸åˆé€‚ã€‚äºæ˜¯æˆ‘æŸ¥é˜…äº†APB AOPå’Œæ‹¦æˆªæŠ€æœ¯ï¼Œå¦å¤–æŸ¥é˜…äº†ABPè‡ªèº«æ³¨å†Œäº†æ‹¦æˆªå™¨â€”â€”UnitOfWorkRegistrarï¼Œä¼šé»˜è®¤ä¸ºç»§æ‰¿è‡ªIRepositoryæˆ–è€…æ˜¯IApplicationServiceçš„ä¸¤ç§ç±»å‹æ·»åŠ UnitOfWorkç‰¹æ€§ï¼Œäºæ˜¯ä¾¿å¯ä»¥é€šè¿‡æ‹¦æˆªæ–¹æ³•å»å®ç°åŠ¨æ€ç¦ç”¨è¿‡æ»¤å™¨ã€‚ å…·ä½“å®ç°é¦–å…ˆåœ¨Application å±‚æ–°å»ºä¸€ä¸ªTenantInterceptor ç»§æ‰¿IInterceptoræ¥å£ 123456789101112131415161718192021222324252627public class TenantInterceptor : IInterceptor&#123; public ILogger Logger &#123; get; set; &#125; public TenantInterceptor() &#123; Logger = NullLogger.Instance; &#125; public void Intercept(IInvocation invocation) &#123; // ä»invocationä¸­æ‹¿åˆ°å½“å‰æ³¨å†Œè¿›æ¥çš„å·¥ä½œå•å…ƒï¼Œä¸»è¦ç”¨äºè·å–TenantId Type t = invocation.InvocationTarget.GetType(); var unitOfWorkManager = (t.GetProperty(&quot;UnitOfWorkManager&quot;).GetValue(invocation.InvocationTarget)) as IUnitOfWorkManager; //æ ¹æ®TenantIdæ˜¯å¦ç¦ç”¨ç§Ÿæˆ·è¿‡æ»¤å™¨ if (unitOfWorkManager.Current.GetTenantId().HasValue) &#123; invocation.Proceed(); // æ‰§è¡Œæ–¹æ³•ä½“ &#125; else &#123; // ç¦ç”¨ç§Ÿæˆ· // PS:è¿™é‡Œä¸å¯ä»¥ä½¿ç”¨ using unitOfWorkManager.Current.DisableFilter(AbpDataFilters.MayHaveTenant, AbpDataFilters.MustHaveTenant); invocation.Proceed(); // æ‰§è¡Œæ–¹æ³•ä½“ &#125; &#125;&#125; æ‹¦æˆªå™¨é‡Œçš„å†…å®¹å¾ˆç®€å•ï¼Œä¸»è¦å°±æ˜¯æ ¹æ®å·¥ä½œå•å…ƒè·å–TenantIdæ¥åŠ¨æ€ç¦ç”¨è¿‡æ»¤å™¨ã€‚å› ä¸ºè¿™é‡Œæ²¡æœ‰éœ€è¦è¿”å›çš„ä¸œè¥¿ï¼Œä¹Ÿå°±ä¸ç”¨åˆ†åŒæ­¥å¼‚æ­¥å»æ‹¦æˆªã€‚æ¥ä¸‹æ¥å°±æ˜¯ä¸ºæ‰€éœ€è¦ç¦ç”¨ç§Ÿæˆ·è¿‡æ»¤å™¨çš„ç±»æ³¨å†Œæ‹¦æˆªå™¨ 123456789101112131415161718192021222324252627282930313233public static class TenantInterceptorRegistrar&#123; public static void Initialize(IKernel kernel) &#123; kernel.ComponentRegistered += Kernel_ComponentRegistered; &#125; private static void Kernel_ComponentRegistered(string key, IHandler handler) &#123; var implementationType = handler.ComponentModel.Implementation.GetTypeInfo(); // ä¸ºå®ç°äº†æ¥å£IRepositoryæ¥å£çš„æ‰€æœ‰ç±»æ³¨å†Œæ‹¦æˆªå™¨ //if (typeof(IRepository).IsAssignableFrom(implementationType)) //&#123; // handler.ComponentModel.Interceptors.Add(new InterceptorReference(typeof(TenantInterceptor))); //&#125; // ä¸ºæŒ‡å®šç±»æ³¨å†Œæ‹¦æˆªå™¨ if (InternalAsyncHelper.DisableFilterTenantTypes.Any(a =&gt; a.IsAssignableFrom(implementationType))) &#123; handler.ComponentModel.Interceptors.Add(new InterceptorReference(typeof(TenantInterceptor))); &#125; &#125;&#125;internal static class InternalAsyncHelper&#123; public static Type[] DisableFilterTenantTypes = &#123; typeof(IRepository&lt;Student,Guid&gt;), typeof(IRepository&lt;School,Guid&gt;) &#125;;&#125; åœ¨TenantInterceptorRegistrarçš„Initializeæ–¹æ³•ä¸­ï¼Œé¦–å…ˆä¼šæ³¨å…¥æ•´ä¸ªABPç³»ç»Ÿä¸­å”¯ä¸€çš„IIocManager,ç„¶åå°±æ˜¯è®¢é˜…å”¯ä¸€çš„IocContainerè¿™ä¸ªå®¹å™¨çš„ComponentRegisteredäº‹ä»¶ï¼Œåœ¨è®¢é˜…äº‹ä»¶ä¸­é¦–å…ˆæ˜¯è·å–å½“å‰è§¦å‘æ­¤äº‹ä»¶çš„ç±»å‹ä¿¡æ¯ï¼Œç„¶åæ ¹æ®éœ€æ±‚æ³¨å†ŒTenantInterceptorè¿™ä¸ªæ‹¦æˆªå™¨ã€‚ è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œæœ¬æ¥æƒ³ä¸ºå®ç°äº†IApplicationServiceæ¥å£çš„ç±»æ³¨å†Œæ‹¦æˆªå™¨ï¼Œä½†æ˜¯ASP.NET Boilerplateä½¿ç”¨åŠ¨æ€æ–¹æ³•æ‹¦æˆªçš„åŠŸèƒ½æœ‰ä¸€äº›é™åˆ¶ å¦‚æœé€šè¿‡æ¥å£è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™å¯ä»¥å°†å…¶ç”¨äºä»»ä½•å…¬å…±æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡æ¥å£ä½¿ç”¨çš„Application Servicesï¼‰ã€‚ å¦‚æœç›´æ¥ä»ç±»å¼•ç”¨ï¼ˆä¾‹å¦‚ASP.NET MVCæˆ–Web APIæ§åˆ¶å™¨ï¼‰ä¸­è°ƒç”¨æ–¹æ³•ï¼Œåˆ™è¯¥æ–¹æ³•åº”ä¸ºè™šæ‹Ÿæ–¹æ³•ã€‚ ä¸€ç§æ–¹æ³•åº”è¯¥æ˜¯è™šæ‹Ÿçš„ï¼Œå¦‚æœå®ƒçš„ä¿æŠ¤ã€‚ ä¹Ÿå°±æ˜¯å¦‚æœå°†æœåŠ¡ä½œä¸ºå®¢æˆ·ç«¯çš„Web APIæ§åˆ¶å™¨å…¬å¼€ï¼Œé‚£ä¹ˆæ–¹æ³•å¿…é¡»æ˜¯è™šæ–¹æ³•ï¼ˆvirtualï¼‰ é™„ä¸Šå®˜æ–¹Git issues æœ€åä¸€æ­¥å°±æ˜¯æŠŠæ‹¦æˆªå™¨åœ¨æ¨¡å—æ–‡ä»¶ä¸­åˆå§‹åŒ– 1234567891011public class ApplicationCoreModule : AbpModule&#123; public override void PreInitialize() &#123; TenantInterceptorRegistrar.Initialize(IocManager.IocContainer.Kernel); &#125; public override void Initialize() &#123; &#125;&#125; è¿™æ ·å°±å¯ä»¥æŒ‰ç€è‡ªå·±çš„éœ€è¦åœ¨DisableFilterTenantTypes ä¸­é…ç½®è‡ªå·±æƒ³é…ç½®çš„ä»“å‚¨äº†ã€‚","categories":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/categories/NET-CORE/"}],"tags":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/tags/NET-CORE/"},{"name":"ABP","slug":"ABP","permalink":"https://zcheng.site/tags/ABP/"},{"name":"AOP","slug":"AOP","permalink":"https://zcheng.site/tags/AOP/"}]}],"categories":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/categories/NET-CORE/"},{"name":"å¾®æœåŠ¡","slug":"NET-CORE/å¾®æœåŠ¡","permalink":"https://zcheng.site/categories/NET-CORE/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"},{"name":"æ¶æ„","slug":"NET-CORE/å¾®æœåŠ¡/æ¶æ„","permalink":"https://zcheng.site/categories/NET-CORE/%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E6%9E%B6%E6%9E%84/"}],"tags":[{"name":".NET CORE","slug":"NET-CORE","permalink":"https://zcheng.site/tags/NET-CORE/"},{"name":"å¾®æœåŠ¡","slug":"å¾®æœåŠ¡","permalink":"https://zcheng.site/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"},{"name":"Ocelot","slug":"Ocelot","permalink":"https://zcheng.site/tags/Ocelot/"},{"name":"Consul","slug":"Consul","permalink":"https://zcheng.site/tags/Consul/"},{"name":"OData","slug":"OData","permalink":"https://zcheng.site/tags/OData/"},{"name":"Autofac","slug":"Autofac","permalink":"https://zcheng.site/tags/Autofac/"},{"name":"ä¾èµ–æ³¨å…¥","slug":"ä¾èµ–æ³¨å…¥","permalink":"https://zcheng.site/tags/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/"},{"name":"ABP","slug":"ABP","permalink":"https://zcheng.site/tags/ABP/"},{"name":"AOP","slug":"AOP","permalink":"https://zcheng.site/tags/AOP/"}]}